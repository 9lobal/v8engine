{"#",e603c0f2-92fb-4d47-8f38-a44a381cf235,
{1,
{13,
{0,"Запрос",
{"Pattern",
{"S",100,1}
},"",174},
{1,"ТекстЗапроса",
{"Pattern"},"",0},
{2,"ПараметрыЗапроса",
{"Pattern"},"",0},
{3,"СпособВыгрузки",
{"Pattern"},"",0},
{4,"ПоказыватьСлужебныеКолонкиРезультата",
{"Pattern"},"",0},
{5,"ТаблицаВыборок",
{"Pattern"},"",0},
{6,"СпособВыборки",
{"Pattern"},"",0},
{7,"ОбходитьИерархическиеВыборкиРекурсивно",
{"Pattern"},"",0},
{8,"ОписаниеЗапроса",
{"Pattern"},"",0},
{9,"ТекстАлгоритма",
{"Pattern"},"",0},
{10,"ВерсииЗапроса",
{"Pattern"},"",0},
{11,"ДатаВерсииЗапроса",
{"Pattern"},"",0},
{12,"ПараметрыАлгоритма",
{"Pattern"},"",0}
},
{2,13,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,
{1,2,
{2,0,13,
{"S","КостыПоМесяцам"},
{"S","ВЫБРАТЬ
	икЗначенияДополнительныхАналитикУУОбъектов.Сотрудник КАК Сотрудник,
	икЗначенияДополнительныхАналитикУУОбъектов.ЗначениеДополнительнойАналитикиУУ,
	икЗначенияДополнительныхАналитикУУОбъектов.Период КАК Период
ПОМЕСТИТЬ ВтИсходная
ИЗ
	РегистрСведений.икЗначенияДополнительныхАналитикУУОбъектов КАК икЗначенияДополнительныхАналитикУУОбъектов
ГДЕ
	икЗначенияДополнительныхАналитикУУОбъектов.ВидДополнительнойАналитикиУУ = &ВидДополнительнойАналитикиУУ
	И икЗначенияДополнительныхАналитикУУОбъектов.Период МЕЖДУ &НачалоПериода И &КонецПериода

ОБЪЕДИНИТЬ

ВЫБРАТЬ
	икЗначенияДополнительныхАналитикУУОбъектовСрезПоследних.Сотрудник,
	икЗначенияДополнительныхАналитикУУОбъектовСрезПоследних.ЗначениеДополнительнойАналитикиУУ,
	&НачалоПериода
ИЗ
	РегистрСведений.икЗначенияДополнительныхАналитикУУОбъектов.СрезПоследних(&НачалоПериода, ВидДополнительнойАналитикиУУ = &ВидДополнительнойАналитикиУУ) КАК икЗначенияДополнительныхАналитикУУОбъектовСрезПоследних
ГДЕ
	икЗначенияДополнительныхАналитикУУОбъектовСрезПоследних.ВидДополнительнойАналитикиУУ = &ВидДополнительнойАналитикиУУ
	И икЗначенияДополнительныхАналитикУУОбъектовСрезПоследних.Период МЕЖДУ &НачалоПериода И &КонецПериода
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ВтИсходная.Сотрудник КАК Сотрудник,
	ВтИсходная.ЗначениеДополнительнойАналитикиУУ,
	ВтИсходная.Период КАК ПериодНачало,
	ВЫБОР
		КОГДА ВтИсходная1.Период ЕСТЬ NULL 
			ТОГДА КОНЕЦПЕРИОДА(&КонецПериода, МЕСЯЦ)
		ИНАЧЕ ДОБАВИТЬКДАТЕ(ВтИсходная1.Период, ДЕНЬ, -1)
	КОНЕЦ КАК ПериодКонец
ПОМЕСТИТЬ ВтПериоды
ИЗ
	ВтИсходная КАК ВтИсходная
		ЛЕВОЕ СОЕДИНЕНИЕ ВтИсходная КАК ВтИсходная1
		ПО ВтИсходная.Сотрудник = ВтИсходная1.Сотрудник
			И ВтИсходная.Период < ВтИсходная1.Период
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗЛИЧНЫЕ
	НАЧАЛОПЕРИОДА(РегламентированныйПроизводственныйКалендарь.ДатаКалендаря, МЕСЯЦ) КАК Месяц
ПОМЕСТИТЬ ВтМесяцы
ИЗ
	РегистрСведений.РегламентированныйПроизводственныйКалендарь КАК РегламентированныйПроизводственныйКалендарь
ГДЕ
	РегламентированныйПроизводственныйКалендарь.ДатаКалендаря МЕЖДУ &НачалоПериода И &КонецПериода
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ВтПериоды.Сотрудник КАК Сотрудник,
	ВтПериоды.ЗначениеДополнительнойАналитикиУУ,
	ВтМесяцы.Месяц КАК НачалоПериода,
	КОНЕЦПЕРИОДА(ВтМесяцы.Месяц, МЕСЯЦ) КАК КонецПериода,
	ВтМесяцы.Месяц КАК Месяц
ИЗ
	ВтМесяцы КАК ВтМесяцы
		ЛЕВОЕ СОЕДИНЕНИЕ ВтПериоды КАК ВтПериоды
		ПО (ВтМесяцы.Месяц МЕЖДУ ВтПериоды.ПериодНачало И ВтПериоды.ПериодКонец)

УПОРЯДОЧИТЬ ПО
	Сотрудник,
	Месяц"},
{"#",acf6192e-81ca-46ef-93a6-5a6968b78663,
{8,
{8,
{0,"ИмяПараметра",
{"Pattern",
{"S",50,1}
},"Имя параметра",22},
{1,"ЭтоВыражение",
{"Pattern",
{"B"}
},"ЭтоВыражение",0},
{2,"ЗначениеПараметра",
{"Pattern",
{"#",280f5f0e-9c8a-49cc-bf6d-4d296cc17a63},
{"#",4772b3b4-f4a3-49c0-a1a5-8cb5961511a3},
{"#",5a49abd5-936d-4f46-8499-9cb204efe378},
{"B"},
{"#",741ae838-6e42-4ac0-b6a4-17e5604b0669},
{"#",872f7198-7083-4e3e-b57e-a2a9802c769e},
{"S",100,1},
{"D"},
{"N",15,3,0}
},"Значение параметра",28},
{3,"МоментВремениДата",
{"Pattern",
{"D"}
},"Момент времени дата",15},
{4,"МоментВремениСсылка",
{"Pattern",
{"#",38bfd075-3e63-4aaa-a93e-94521380d579}
},"Момент времени ссылка",15},
{5,"ГраницаЗначение",
{"Pattern",
{"#",38bfd075-3e63-4aaa-a93e-94521380d579},
{"D"}
},"Граница значение",15},
{6,"ГраницаВид",
{"Pattern",
{"S"}
},"Граница вид сравнения",15},
{7,"ТаблицаЗначений",
{"Pattern"},"",0}
},
{2,8,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,
{1,3,
{2,0,8,
{"S","ВидДополнительнойАналитикиУУ"},
{"B",0},
{"#",af50d627-2650-4410-aaf0-8cf34c5997bc,12242:9e1af62ce9b4e3534f55bff307437d31},
{"D",00010101000000},
{"U"},
{"U"},
{"S",""},
{"U"},0},
{2,1,8,
{"S","КонецПериода"},
{"B",0},
{"D",20171231000000},
{"D",00010101000000},
{"U"},
{"U"},
{"S",""},
{"U"},0},
{2,2,8,
{"S","НачалоПериода"},
{"B",0},
{"D",20170101000000},
{"D",00010101000000},
{"U"},
{"U"},
{"S",""},
{"U"},0}
},-1,2}
}
},
{"N",1},
{"B",0},
{"#",acf6192e-81ca-46ef-93a6-5a6968b78663,
{8,
{5,
{0,"Включена",
{"Pattern",
{"B"}
},"Включена",0},
{1,"ТипОбхода",
{"Pattern"},"Тип обхода",19},
{2,"Группировки",
{"Pattern",
{"S"}
},"Группировки",21},
{3,"ГруппировкиДляЗначенийГруппировок",
{"Pattern",
{"S"}
},"Группировки для значений группировок",30},
{4,"Имя",
{"Pattern",
{"S"}
},"Имя выборки",16}
},
{2,5,0,0,1,1,2,2,3,3,4,4,
{1,0},-1,-1}
}
},
{"N",1},
{"B",0},
{"S",""},
{"U"},
{"#",acf6192e-81ca-46ef-93a6-5a6968b78663,
{8,
{3,
{0,"ДатаВерсии",
{"Pattern"},"",0},
{1,"ТекстЗапроса",
{"Pattern"},"",0},
{2,"Параметры",
{"Pattern"},"",0}
},
{2,3,0,0,1,1,2,2,
{1,13,
{2,0,3,
{"D",20171101144739},
{"S","ВЫБРАТЬ
	икЗначенияДополнительныхАналитикУУОбъектов.Сотрудник КАК Сотрудник,
	икЗначенияДополнительныхАналитикУУОбъектов.ЗначениеДополнительнойАналитикиУУ,
	икЗначенияДополнительныхАналитикУУОбъектов.Период КАК Период
ИЗ
	РегистрСведений.икЗначенияДополнительныхАналитикУУОбъектов КАК икЗначенияДополнительныхАналитикУУОбъектов
ГДЕ
	икЗначенияДополнительныхАналитикУУОбъектов.ВидДополнительнойАналитикиУУ = &ВидДополнительнойАналитикиУУ
	И икЗначенияДополнительныхАналитикУУОбъектов.Период МЕЖДУ &НачалоПериода И &КонецПериода

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	икЗначенияДополнительныхАналитикУУОбъектовСрезПоследних.Сотрудник,
	икЗначенияДополнительныхАналитикУУОбъектовСрезПоследних.ЗначениеДополнительнойАналитикиУУ,
	&НачалоПериода
ИЗ
	РегистрСведений.икЗначенияДополнительныхАналитикУУОбъектов.СрезПоследних(&НачалоПериода, ВидДополнительнойАналитикиУУ = &ВидДополнительнойАналитикиУУ) КАК икЗначенияДополнительныхАналитикУУОбъектовСрезПоследних
ГДЕ
	икЗначенияДополнительныхАналитикУУОбъектовСрезПоследних.ВидДополнительнойАналитикиУУ = &ВидДополнительнойАналитикиУУ
	И икЗначенияДополнительныхАналитикУУОбъектовСрезПоследних.Период МЕЖДУ &НачалоПериода И &КонецПериода

УПОРЯДОЧИТЬ ПО
	Период,
	Сотрудник"},
{"#",acf6192e-81ca-46ef-93a6-5a6968b78663,
{8,
{8,
{0,"ИмяПараметра",
{"Pattern",
{"S",50,1}
},"Имя параметра",22},
{1,"ЭтоВыражение",
{"Pattern",
{"B"}
},"ЭтоВыражение",0},
{2,"ЗначениеПараметра",
{"Pattern",
{"#",280f5f0e-9c8a-49cc-bf6d-4d296cc17a63},
{"#",4772b3b4-f4a3-49c0-a1a5-8cb5961511a3},
{"#",5a49abd5-936d-4f46-8499-9cb204efe378},
{"B"},
{"#",741ae838-6e42-4ac0-b6a4-17e5604b0669},
{"#",872f7198-7083-4e3e-b57e-a2a9802c769e},
{"S",100,1},
{"D"},
{"N",15,3,0}
},"Значение параметра",28},
{3,"МоментВремениДата",
{"Pattern",
{"D"}
},"Момент времени дата",15},
{4,"МоментВремениСсылка",
{"Pattern",
{"#",38bfd075-3e63-4aaa-a93e-94521380d579}
},"Момент времени ссылка",15},
{5,"ГраницаЗначение",
{"Pattern",
{"#",38bfd075-3e63-4aaa-a93e-94521380d579},
{"D"}
},"Граница значение",15},
{6,"ГраницаВид",
{"Pattern",
{"S"}
},"Граница вид сравнения",15},
{7,"ТаблицаЗначений",
{"Pattern"},"",0}
},
{2,8,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,
{1,3,
{2,0,8,
{"S","ВидДополнительнойАналитикиУУ"},
{"B",0},
{"U"},
{"D",00010101000000},
{"U"},
{"U"},
{"S",""},
{"U"},0},
{2,1,8,
{"S","КонецПериода"},
{"B",0},
{"D",00010101000000},
{"D",00010101000000},
{"U"},
{"U"},
{"S",""},
{"U"},0},
{2,2,8,
{"S","НачалоПериода"},
{"B",0},
{"D",00010101000000},
{"D",00010101000000},
{"U"},
{"U"},
{"S",""},
{"U"},0}
},-1,2}
}
},0},
{2,1,3,
{"D",20171101144753},
{"S","ВЫБРАТЬ
	икЗначенияДополнительныхАналитикУУОбъектов.Сотрудник КАК Сотрудник,
	икЗначенияДополнительныхАналитикУУОбъектов.ЗначениеДополнительнойАналитикиУУ,
	икЗначенияДополнительныхАналитикУУОбъектов.Период КАК Период
ИЗ
	РегистрСведений.икЗначенияДополнительныхАналитикУУОбъектов КАК икЗначенияДополнительныхАналитикУУОбъектов
ГДЕ
	икЗначенияДополнительныхАналитикУУОбъектов.ВидДополнительнойАналитикиУУ = &ВидДополнительнойАналитикиУУ
	И икЗначенияДополнительныхАналитикУУОбъектов.Период МЕЖДУ &НачалоПериода И &КонецПериода

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	икЗначенияДополнительныхАналитикУУОбъектовСрезПоследних.Сотрудник,
	икЗначенияДополнительныхАналитикУУОбъектовСрезПоследних.ЗначениеДополнительнойАналитикиУУ,
	&НачалоПериода
ИЗ
	РегистрСведений.икЗначенияДополнительныхАналитикУУОбъектов.СрезПоследних(&НачалоПериода, ВидДополнительнойАналитикиУУ = &ВидДополнительнойАналитикиУУ) КАК икЗначенияДополнительныхАналитикУУОбъектовСрезПоследних
ГДЕ
	икЗначенияДополнительныхАналитикУУОбъектовСрезПоследних.ВидДополнительнойАналитикиУУ = &ВидДополнительнойАналитикиУУ
	И икЗначенияДополнительныхАналитикУУОбъектовСрезПоследних.Период МЕЖДУ &НачалоПериода И &КонецПериода

УПОРЯДОЧИТЬ ПО
	Период,
	Сотрудник"},
{"#",acf6192e-81ca-46ef-93a6-5a6968b78663,
{8,
{8,
{0,"ИмяПараметра",
{"Pattern",
{"S",50,1}
},"Имя параметра",22},
{1,"ЭтоВыражение",
{"Pattern",
{"B"}
},"ЭтоВыражение",0},
{2,"ЗначениеПараметра",
{"Pattern",
{"#",280f5f0e-9c8a-49cc-bf6d-4d296cc17a63},
{"#",4772b3b4-f4a3-49c0-a1a5-8cb5961511a3},
{"#",5a49abd5-936d-4f46-8499-9cb204efe378},
{"B"},
{"#",741ae838-6e42-4ac0-b6a4-17e5604b0669},
{"#",872f7198-7083-4e3e-b57e-a2a9802c769e},
{"S",100,1},
{"D"},
{"N",15,3,0}
},"Значение параметра",28},
{3,"МоментВремениДата",
{"Pattern",
{"D"}
},"Момент времени дата",15},
{4,"МоментВремениСсылка",
{"Pattern",
{"#",38bfd075-3e63-4aaa-a93e-94521380d579}
},"Момент времени ссылка",15},
{5,"ГраницаЗначение",
{"Pattern",
{"#",38bfd075-3e63-4aaa-a93e-94521380d579},
{"D"}
},"Граница значение",15},
{6,"ГраницаВид",
{"Pattern",
{"S"}
},"Граница вид сравнения",15},
{7,"ТаблицаЗначений",
{"Pattern"},"",0}
},
{2,8,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,
{1,3,
{2,0,8,
{"S","ВидДополнительнойАналитикиУУ"},
{"B",0},
{"#",af50d627-2650-4410-aaf0-8cf34c5997bc,12242:9e1af62ce9b4e3534f55bff307437d31},
{"D",00010101000000},
{"U"},
{"U"},
{"S",""},
{"U"},0},
{2,1,8,
{"S","КонецПериода"},
{"B",0},
{"D",20170930000000},
{"D",00010101000000},
{"U"},
{"U"},
{"S",""},
{"U"},0},
{2,2,8,
{"S","НачалоПериода"},
{"B",0},
{"D",20170101000000},
{"D",00010101000000},
{"U"},
{"U"},
{"S",""},
{"U"},0}
},-1,2}
}
},0},
{2,2,3,
{"D",20171101144824},
{"S","ВЫБРАТЬ
	икЗначенияДополнительныхАналитикУУОбъектов.Сотрудник КАК Сотрудник,
	икЗначенияДополнительныхАналитикУУОбъектов.ЗначениеДополнительнойАналитикиУУ,
	икЗначенияДополнительныхАналитикУУОбъектов.Период КАК Период
ИЗ
	РегистрСведений.икЗначенияДополнительныхАналитикУУОбъектов КАК икЗначенияДополнительныхАналитикУУОбъектов
ГДЕ
	икЗначенияДополнительныхАналитикУУОбъектов.ВидДополнительнойАналитикиУУ = &ВидДополнительнойАналитикиУУ
	И икЗначенияДополнительныхАналитикУУОбъектов.Период МЕЖДУ &НачалоПериода И &КонецПериода

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	икЗначенияДополнительныхАналитикУУОбъектовСрезПоследних.Сотрудник,
	икЗначенияДополнительныхАналитикУУОбъектовСрезПоследних.ЗначениеДополнительнойАналитикиУУ,
	&НачалоПериода
ИЗ
	РегистрСведений.икЗначенияДополнительныхАналитикУУОбъектов.СрезПоследних(&НачалоПериода, ВидДополнительнойАналитикиУУ = &ВидДополнительнойАналитикиУУ) КАК икЗначенияДополнительныхАналитикУУОбъектовСрезПоследних
ГДЕ
	икЗначенияДополнительныхАналитикУУОбъектовСрезПоследних.ВидДополнительнойАналитикиУУ = &ВидДополнительнойАналитикиУУ
	И икЗначенияДополнительныхАналитикУУОбъектовСрезПоследних.Период МЕЖДУ &НачалоПериода И &КонецПериода

УПОРЯДОЧИТЬ ПО
	Сотрудник,
	Период"},
{"#",acf6192e-81ca-46ef-93a6-5a6968b78663,
{8,
{8,
{0,"ИмяПараметра",
{"Pattern",
{"S",50,1}
},"Имя параметра",22},
{1,"ЭтоВыражение",
{"Pattern",
{"B"}
},"ЭтоВыражение",0},
{2,"ЗначениеПараметра",
{"Pattern",
{"#",280f5f0e-9c8a-49cc-bf6d-4d296cc17a63},
{"#",4772b3b4-f4a3-49c0-a1a5-8cb5961511a3},
{"#",5a49abd5-936d-4f46-8499-9cb204efe378},
{"B"},
{"#",741ae838-6e42-4ac0-b6a4-17e5604b0669},
{"#",872f7198-7083-4e3e-b57e-a2a9802c769e},
{"S",100,1},
{"D"},
{"N",15,3,0}
},"Значение параметра",28},
{3,"МоментВремениДата",
{"Pattern",
{"D"}
},"Момент времени дата",15},
{4,"МоментВремениСсылка",
{"Pattern",
{"#",38bfd075-3e63-4aaa-a93e-94521380d579}
},"Момент времени ссылка",15},
{5,"ГраницаЗначение",
{"Pattern",
{"#",38bfd075-3e63-4aaa-a93e-94521380d579},
{"D"}
},"Граница значение",15},
{6,"ГраницаВид",
{"Pattern",
{"S"}
},"Граница вид сравнения",15},
{7,"ТаблицаЗначений",
{"Pattern"},"",0}
},
{2,8,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,
{1,3,
{2,0,8,
{"S","ВидДополнительнойАналитикиУУ"},
{"B",0},
{"#",af50d627-2650-4410-aaf0-8cf34c5997bc,12242:9e1af62ce9b4e3534f55bff307437d31},
{"D",00010101000000},
{"U"},
{"U"},
{"S",""},
{"U"},0},
{2,1,8,
{"S","КонецПериода"},
{"B",0},
{"D",20170930000000},
{"D",00010101000000},
{"U"},
{"U"},
{"S",""},
{"U"},0},
{2,2,8,
{"S","НачалоПериода"},
{"B",0},
{"D",20170101000000},
{"D",00010101000000},
{"U"},
{"U"},
{"S",""},
{"U"},0}
},-1,2}
}
},0},
{2,3,3,
{"D",20171101144842},
{"S","ВЫБРАТЬ
	икЗначенияДополнительныхАналитикУУОбъектов.Сотрудник КАК Сотрудник,
	икЗначенияДополнительныхАналитикУУОбъектов.ЗначениеДополнительнойАналитикиУУ,
	икЗначенияДополнительныхАналитикУУОбъектов.Период КАК Период
ИЗ
	РегистрСведений.икЗначенияДополнительныхАналитикУУОбъектов КАК икЗначенияДополнительныхАналитикУУОбъектов
ГДЕ
	икЗначенияДополнительныхАналитикУУОбъектов.ВидДополнительнойАналитикиУУ = &ВидДополнительнойАналитикиУУ
	И икЗначенияДополнительныхАналитикУУОбъектов.Период МЕЖДУ &НачалоПериода И &КонецПериода

ОБЪЕДИНИТЬ

ВЫБРАТЬ
	икЗначенияДополнительныхАналитикУУОбъектовСрезПоследних.Сотрудник,
	икЗначенияДополнительныхАналитикУУОбъектовСрезПоследних.ЗначениеДополнительнойАналитикиУУ,
	&НачалоПериода
ИЗ
	РегистрСведений.икЗначенияДополнительныхАналитикУУОбъектов.СрезПоследних(&НачалоПериода, ВидДополнительнойАналитикиУУ = &ВидДополнительнойАналитикиУУ) КАК икЗначенияДополнительныхАналитикУУОбъектовСрезПоследних
ГДЕ
	икЗначенияДополнительныхАналитикУУОбъектовСрезПоследних.ВидДополнительнойАналитикиУУ = &ВидДополнительнойАналитикиУУ
	И икЗначенияДополнительныхАналитикУУОбъектовСрезПоследних.Период МЕЖДУ &НачалоПериода И &КонецПериода

УПОРЯДОЧИТЬ ПО
	Сотрудник,
	Период"},
{"#",acf6192e-81ca-46ef-93a6-5a6968b78663,
{8,
{8,
{0,"ИмяПараметра",
{"Pattern",
{"S",50,1}
},"Имя параметра",22},
{1,"ЭтоВыражение",
{"Pattern",
{"B"}
},"ЭтоВыражение",0},
{2,"ЗначениеПараметра",
{"Pattern",
{"#",280f5f0e-9c8a-49cc-bf6d-4d296cc17a63},
{"#",4772b3b4-f4a3-49c0-a1a5-8cb5961511a3},
{"#",5a49abd5-936d-4f46-8499-9cb204efe378},
{"B"},
{"#",741ae838-6e42-4ac0-b6a4-17e5604b0669},
{"#",872f7198-7083-4e3e-b57e-a2a9802c769e},
{"S",100,1},
{"D"},
{"N",15,3,0}
},"Значение параметра",28},
{3,"МоментВремениДата",
{"Pattern",
{"D"}
},"Момент времени дата",15},
{4,"МоментВремениСсылка",
{"Pattern",
{"#",38bfd075-3e63-4aaa-a93e-94521380d579}
},"Момент времени ссылка",15},
{5,"ГраницаЗначение",
{"Pattern",
{"#",38bfd075-3e63-4aaa-a93e-94521380d579},
{"D"}
},"Граница значение",15},
{6,"ГраницаВид",
{"Pattern",
{"S"}
},"Граница вид сравнения",15},
{7,"ТаблицаЗначений",
{"Pattern"},"",0}
},
{2,8,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,
{1,3,
{2,0,8,
{"S","ВидДополнительнойАналитикиУУ"},
{"B",0},
{"#",af50d627-2650-4410-aaf0-8cf34c5997bc,12242:9e1af62ce9b4e3534f55bff307437d31},
{"D",00010101000000},
{"U"},
{"U"},
{"S",""},
{"U"},0},
{2,1,8,
{"S","КонецПериода"},
{"B",0},
{"D",20170930000000},
{"D",00010101000000},
{"U"},
{"U"},
{"S",""},
{"U"},0},
{2,2,8,
{"S","НачалоПериода"},
{"B",0},
{"D",20170101000000},
{"D",00010101000000},
{"U"},
{"U"},
{"S",""},
{"U"},0}
},-1,2}
}
},0},
{2,4,3,
{"D",20171101144907},
{"S","ВЫБРАТЬ
	икЗначенияДополнительныхАналитикУУОбъектов.Сотрудник КАК Сотрудник,
	икЗначенияДополнительныхАналитикУУОбъектов.ЗначениеДополнительнойАналитикиУУ,
	икЗначенияДополнительныхАналитикУУОбъектов.Период КАК Период
ИЗ
	РегистрСведений.икЗначенияДополнительныхАналитикУУОбъектов КАК икЗначенияДополнительныхАналитикУУОбъектов
ГДЕ
	икЗначенияДополнительныхАналитикУУОбъектов.ВидДополнительнойАналитикиУУ = &ВидДополнительнойАналитикиУУ
	И икЗначенияДополнительныхАналитикУУОбъектов.Период МЕЖДУ &НачалоПериода И &КонецПериода

ОБЪЕДИНИТЬ

ВЫБРАТЬ
	икЗначенияДополнительныхАналитикУУОбъектовСрезПоследних.Сотрудник,
	икЗначенияДополнительныхАналитикУУОбъектовСрезПоследних.ЗначениеДополнительнойАналитикиУУ,
	&НачалоПериода
ИЗ
	РегистрСведений.икЗначенияДополнительныхАналитикУУОбъектов.СрезПоследних(&НачалоПериода, ВидДополнительнойАналитикиУУ = &ВидДополнительнойАналитикиУУ) КАК икЗначенияДополнительныхАналитикУУОбъектовСрезПоследних
ГДЕ
	икЗначенияДополнительныхАналитикУУОбъектовСрезПоследних.ВидДополнительнойАналитикиУУ = &ВидДополнительнойАналитикиУУ
	И икЗначенияДополнительныхАналитикУУОбъектовСрезПоследних.Период МЕЖДУ &НачалоПериода И &КонецПериода

УПОРЯДОЧИТЬ ПО
	Сотрудник,
	Период"},
{"#",acf6192e-81ca-46ef-93a6-5a6968b78663,
{8,
{8,
{0,"ИмяПараметра",
{"Pattern",
{"S",50,1}
},"Имя параметра",22},
{1,"ЭтоВыражение",
{"Pattern",
{"B"}
},"ЭтоВыражение",0},
{2,"ЗначениеПараметра",
{"Pattern",
{"#",280f5f0e-9c8a-49cc-bf6d-4d296cc17a63},
{"#",4772b3b4-f4a3-49c0-a1a5-8cb5961511a3},
{"#",5a49abd5-936d-4f46-8499-9cb204efe378},
{"B"},
{"#",741ae838-6e42-4ac0-b6a4-17e5604b0669},
{"#",872f7198-7083-4e3e-b57e-a2a9802c769e},
{"S",100,1},
{"D"},
{"N",15,3,0}
},"Значение параметра",28},
{3,"МоментВремениДата",
{"Pattern",
{"D"}
},"Момент времени дата",15},
{4,"МоментВремениСсылка",
{"Pattern",
{"#",38bfd075-3e63-4aaa-a93e-94521380d579}
},"Момент времени ссылка",15},
{5,"ГраницаЗначение",
{"Pattern",
{"#",38bfd075-3e63-4aaa-a93e-94521380d579},
{"D"}
},"Граница значение",15},
{6,"ГраницаВид",
{"Pattern",
{"S"}
},"Граница вид сравнения",15},
{7,"ТаблицаЗначений",
{"Pattern"},"",0}
},
{2,8,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,
{1,3,
{2,0,8,
{"S","ВидДополнительнойАналитикиУУ"},
{"B",0},
{"#",af50d627-2650-4410-aaf0-8cf34c5997bc,12242:9e1af62ce9b4e3534f55bff307437d31},
{"D",00010101000000},
{"U"},
{"U"},
{"S",""},
{"U"},0},
{2,1,8,
{"S","КонецПериода"},
{"B",0},
{"D",20171231000000},
{"D",00010101000000},
{"U"},
{"U"},
{"S",""},
{"U"},0},
{2,2,8,
{"S","НачалоПериода"},
{"B",0},
{"D",20170101000000},
{"D",00010101000000},
{"U"},
{"U"},
{"S",""},
{"U"},0}
},-1,2}
}
},0},
{2,5,3,
{"D",20171101145105},
{"S","ВЫБРАТЬ
	икЗначенияДополнительныхАналитикУУОбъектов.Сотрудник КАК Сотрудник,
	икЗначенияДополнительныхАналитикУУОбъектов.ЗначениеДополнительнойАналитикиУУ,
	икЗначенияДополнительныхАналитикУУОбъектов.Период КАК Период
ПОМЕСТИТЬ ВтАналитики
ИЗ
	РегистрСведений.икЗначенияДополнительныхАналитикУУОбъектов КАК икЗначенияДополнительныхАналитикУУОбъектов
ГДЕ
	икЗначенияДополнительныхАналитикУУОбъектов.ВидДополнительнойАналитикиУУ = &ВидДополнительнойАналитикиУУ
	И икЗначенияДополнительныхАналитикУУОбъектов.Период МЕЖДУ &НачалоПериода И &КонецПериода

ОБЪЕДИНИТЬ

ВЫБРАТЬ
	икЗначенияДополнительныхАналитикУУОбъектовСрезПоследних.Сотрудник,
	икЗначенияДополнительныхАналитикУУОбъектовСрезПоследних.ЗначениеДополнительнойАналитикиУУ,
	&НачалоПериода
ИЗ
	РегистрСведений.икЗначенияДополнительныхАналитикУУОбъектов.СрезПоследних(&НачалоПериода, ВидДополнительнойАналитикиУУ = &ВидДополнительнойАналитикиУУ) КАК икЗначенияДополнительныхАналитикУУОбъектовСрезПоследних
ГДЕ
	икЗначенияДополнительныхАналитикУУОбъектовСрезПоследних.ВидДополнительнойАналитикиУУ = &ВидДополнительнойАналитикиУУ
	И икЗначенияДополнительныхАналитикУУОбъектовСрезПоследних.Период МЕЖДУ &НачалоПериода И &КонецПериода
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ВтАналитики.Сотрудник КАК Сотрудник,
	ВтАналитики.ЗначениеДополнительнойАналитикиУУ,
	ВтАналитики.Период КАК ПериодНачало,
	ВтАналитики1.Период КАК ПериодКонец
ИЗ
	ВтАналитики КАК ВтАналитики
		ЛЕВОЕ СОЕДИНЕНИЕ ВтАналитики КАК ВтАналитики1
		ПО ВтАналитики.Сотрудник = ВтАналитики1.Сотрудник
			И ВтАналитики.Период < ВтАналитики1.Период

УПОРЯДОЧИТЬ ПО
	Сотрудник,
	ПериодНачало"},
{"#",acf6192e-81ca-46ef-93a6-5a6968b78663,
{8,
{8,
{0,"ИмяПараметра",
{"Pattern",
{"S",50,1}
},"Имя параметра",22},
{1,"ЭтоВыражение",
{"Pattern",
{"B"}
},"ЭтоВыражение",0},
{2,"ЗначениеПараметра",
{"Pattern",
{"#",280f5f0e-9c8a-49cc-bf6d-4d296cc17a63},
{"#",4772b3b4-f4a3-49c0-a1a5-8cb5961511a3},
{"#",5a49abd5-936d-4f46-8499-9cb204efe378},
{"B"},
{"#",741ae838-6e42-4ac0-b6a4-17e5604b0669},
{"#",872f7198-7083-4e3e-b57e-a2a9802c769e},
{"S",100,1},
{"D"},
{"N",15,3,0}
},"Значение параметра",28},
{3,"МоментВремениДата",
{"Pattern",
{"D"}
},"Момент времени дата",15},
{4,"МоментВремениСсылка",
{"Pattern",
{"#",38bfd075-3e63-4aaa-a93e-94521380d579}
},"Момент времени ссылка",15},
{5,"ГраницаЗначение",
{"Pattern",
{"#",38bfd075-3e63-4aaa-a93e-94521380d579},
{"D"}
},"Граница значение",15},
{6,"ГраницаВид",
{"Pattern",
{"S"}
},"Граница вид сравнения",15},
{7,"ТаблицаЗначений",
{"Pattern"},"",0}
},
{2,8,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,
{1,3,
{2,0,8,
{"S","ВидДополнительнойАналитикиУУ"},
{"B",0},
{"#",af50d627-2650-4410-aaf0-8cf34c5997bc,12242:9e1af62ce9b4e3534f55bff307437d31},
{"D",00010101000000},
{"U"},
{"U"},
{"S",""},
{"U"},0},
{2,1,8,
{"S","КонецПериода"},
{"B",0},
{"D",20171231000000},
{"D",00010101000000},
{"U"},
{"U"},
{"S",""},
{"U"},0},
{2,2,8,
{"S","НачалоПериода"},
{"B",0},
{"D",20170101000000},
{"D",00010101000000},
{"U"},
{"U"},
{"S",""},
{"U"},0}
},-1,2}
}
},0},
{2,6,3,
{"D",20171101145207},
{"S","ВЫБРАТЬ
	икЗначенияДополнительныхАналитикУУОбъектов.Сотрудник КАК Сотрудник,
	икЗначенияДополнительныхАналитикУУОбъектов.ЗначениеДополнительнойАналитикиУУ,
	икЗначенияДополнительныхАналитикУУОбъектов.Период КАК Период
ПОМЕСТИТЬ ВтАналитики
ИЗ
	РегистрСведений.икЗначенияДополнительныхАналитикУУОбъектов КАК икЗначенияДополнительныхАналитикУУОбъектов
ГДЕ
	икЗначенияДополнительныхАналитикУУОбъектов.ВидДополнительнойАналитикиУУ = &ВидДополнительнойАналитикиУУ
	И икЗначенияДополнительныхАналитикУУОбъектов.Период МЕЖДУ &НачалоПериода И &КонецПериода

ОБЪЕДИНИТЬ

ВЫБРАТЬ
	икЗначенияДополнительныхАналитикУУОбъектовСрезПоследних.Сотрудник,
	икЗначенияДополнительныхАналитикУУОбъектовСрезПоследних.ЗначениеДополнительнойАналитикиУУ,
	&НачалоПериода
ИЗ
	РегистрСведений.икЗначенияДополнительныхАналитикУУОбъектов.СрезПоследних(&НачалоПериода, ВидДополнительнойАналитикиУУ = &ВидДополнительнойАналитикиУУ) КАК икЗначенияДополнительныхАналитикУУОбъектовСрезПоследних
ГДЕ
	икЗначенияДополнительныхАналитикУУОбъектовСрезПоследних.ВидДополнительнойАналитикиУУ = &ВидДополнительнойАналитикиУУ
	И икЗначенияДополнительныхАналитикУУОбъектовСрезПоследних.Период МЕЖДУ &НачалоПериода И &КонецПериода
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ВтАналитики.Сотрудник КАК Сотрудник,
	ВтАналитики.ЗначениеДополнительнойАналитикиУУ,
	ВтАналитики.Период КАК ПериодНачало,
	ВЫБОР
		КОГДА ВтАналитики1.Период ЕСТЬ NULL 
			ТОГДА КОНЕЦПЕРИОДА(&КонецПериода, МЕСЯЦ)
		ИНАЧЕ ДОБАВИТЬКДАТЕ(ВтАналитики1.Период, ДЕНЬ, -1)
	КОНЕЦ КАК ПериодКонец
ИЗ
	ВтАналитики КАК ВтАналитики
		ЛЕВОЕ СОЕДИНЕНИЕ ВтАналитики КАК ВтАналитики1
		ПО ВтАналитики.Сотрудник = ВтАналитики1.Сотрудник
			И ВтАналитики.Период < ВтАналитики1.Период

УПОРЯДОЧИТЬ ПО
	Сотрудник,
	ПериодНачало"},
{"#",acf6192e-81ca-46ef-93a6-5a6968b78663,
{8,
{8,
{0,"ИмяПараметра",
{"Pattern",
{"S",50,1}
},"Имя параметра",22},
{1,"ЭтоВыражение",
{"Pattern",
{"B"}
},"ЭтоВыражение",0},
{2,"ЗначениеПараметра",
{"Pattern",
{"#",280f5f0e-9c8a-49cc-bf6d-4d296cc17a63},
{"#",4772b3b4-f4a3-49c0-a1a5-8cb5961511a3},
{"#",5a49abd5-936d-4f46-8499-9cb204efe378},
{"B"},
{"#",741ae838-6e42-4ac0-b6a4-17e5604b0669},
{"#",872f7198-7083-4e3e-b57e-a2a9802c769e},
{"S",100,1},
{"D"},
{"N",15,3,0}
},"Значение параметра",28},
{3,"МоментВремениДата",
{"Pattern",
{"D"}
},"Момент времени дата",15},
{4,"МоментВремениСсылка",
{"Pattern",
{"#",38bfd075-3e63-4aaa-a93e-94521380d579}
},"Момент времени ссылка",15},
{5,"ГраницаЗначение",
{"Pattern",
{"#",38bfd075-3e63-4aaa-a93e-94521380d579},
{"D"}
},"Граница значение",15},
{6,"ГраницаВид",
{"Pattern",
{"S"}
},"Граница вид сравнения",15},
{7,"ТаблицаЗначений",
{"Pattern"},"",0}
},
{2,8,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,
{1,3,
{2,0,8,
{"S","ВидДополнительнойАналитикиУУ"},
{"B",0},
{"#",af50d627-2650-4410-aaf0-8cf34c5997bc,12242:9e1af62ce9b4e3534f55bff307437d31},
{"D",00010101000000},
{"U"},
{"U"},
{"S",""},
{"U"},0},
{2,1,8,
{"S","КонецПериода"},
{"B",0},
{"D",20171231000000},
{"D",00010101000000},
{"U"},
{"U"},
{"S",""},
{"U"},0},
{2,2,8,
{"S","НачалоПериода"},
{"B",0},
{"D",20170101000000},
{"D",00010101000000},
{"U"},
{"U"},
{"S",""},
{"U"},0}
},-1,2}
}
},0},
{2,7,3,
{"D",20171101145841},
{"S","ВЫБРАТЬ
	икЗначенияДополнительныхАналитикУУОбъектов.Сотрудник КАК Сотрудник,
	икЗначенияДополнительныхАналитикУУОбъектов.ЗначениеДополнительнойАналитикиУУ,
	икЗначенияДополнительныхАналитикУУОбъектов.Период КАК Период
ПОМЕСТИТЬ ВтАналитики
ИЗ
	РегистрСведений.икЗначенияДополнительныхАналитикУУОбъектов КАК икЗначенияДополнительныхАналитикУУОбъектов
ГДЕ
	икЗначенияДополнительныхАналитикУУОбъектов.ВидДополнительнойАналитикиУУ = &ВидДополнительнойАналитикиУУ
	И икЗначенияДополнительныхАналитикУУОбъектов.Период МЕЖДУ &НачалоПериода И &КонецПериода

ОБЪЕДИНИТЬ

ВЫБРАТЬ
	икЗначенияДополнительныхАналитикУУОбъектовСрезПоследних.Сотрудник,
	икЗначенияДополнительныхАналитикУУОбъектовСрезПоследних.ЗначениеДополнительнойАналитикиУУ,
	&НачалоПериода
ИЗ
	РегистрСведений.икЗначенияДополнительныхАналитикУУОбъектов.СрезПоследних(&НачалоПериода, ВидДополнительнойАналитикиУУ = &ВидДополнительнойАналитикиУУ) КАК икЗначенияДополнительныхАналитикУУОбъектовСрезПоследних
ГДЕ
	икЗначенияДополнительныхАналитикУУОбъектовСрезПоследних.ВидДополнительнойАналитикиУУ = &ВидДополнительнойАналитикиУУ
	И икЗначенияДополнительныхАналитикУУОбъектовСрезПоследних.Период МЕЖДУ &НачалоПериода И &КонецПериода
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ВтАналитики.Сотрудник КАК Сотрудник,
	ВтАналитики.ЗначениеДополнительнойАналитикиУУ,
	ВтАналитики.Период КАК ПериодНачало,
	ВЫБОР
		КОГДА ВтАналитики1.Период ЕСТЬ NULL 
			ТОГДА КОНЕЦПЕРИОДА(&КонецПериода, МЕСЯЦ)
		ИНАЧЕ ДОБАВИТЬКДАТЕ(ВтАналитики1.Период, ДЕНЬ, -1)
	КОНЕЦ КАК ПериодКонец
ПОМЕСТИТЬ ВтПериоды
ИЗ
	ВтАналитики КАК ВтАналитики
		ЛЕВОЕ СОЕДИНЕНИЕ ВтАналитики КАК ВтАналитики1
		ПО ВтАналитики.Сотрудник = ВтАналитики1.Сотрудник
			И ВтАналитики.Период < ВтАналитики1.Период
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	НАЧАЛОПЕРИОДА(РегламентированныйПроизводственныйКалендарь.ДатаКалендаря, МЕСЯЦ) КАК Месяц
ПОМЕСТИТЬ ВтМесяцы
ИЗ
	РегистрСведений.РегламентированныйПроизводственныйКалендарь КАК РегламентированныйПроизводственныйКалендарь
ГДЕ
	РегламентированныйПроизводственныйКалендарь.ДатаКалендаря МЕЖДУ &НачалоПериода И &КонецПериода
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ВтПериоды.Сотрудник КАК Сотрудник,
	ВтПериоды.ЗначениеДополнительнойАналитикиУУ,
	ВтПериоды.ПериодНачало,
	ВтПериоды.ПериодКонец,
	ВтМесяцы.Месяц КАК Месяц
ИЗ
	ВтМесяцы КАК ВтМесяцы
		ЛЕВОЕ СОЕДИНЕНИЕ ВтПериоды КАК ВтПериоды
		ПО (ВтМесяцы.Месяц МЕЖДУ ВтПериоды.ПериодНачало И ВтПериоды.ПериодКонец)

УПОРЯДОЧИТЬ ПО
	Месяц,
	Сотрудник"},
{"#",acf6192e-81ca-46ef-93a6-5a6968b78663,
{8,
{8,
{0,"ИмяПараметра",
{"Pattern",
{"S",50,1}
},"Имя параметра",22},
{1,"ЭтоВыражение",
{"Pattern",
{"B"}
},"ЭтоВыражение",0},
{2,"ЗначениеПараметра",
{"Pattern",
{"#",280f5f0e-9c8a-49cc-bf6d-4d296cc17a63},
{"#",4772b3b4-f4a3-49c0-a1a5-8cb5961511a3},
{"#",5a49abd5-936d-4f46-8499-9cb204efe378},
{"B"},
{"#",741ae838-6e42-4ac0-b6a4-17e5604b0669},
{"#",872f7198-7083-4e3e-b57e-a2a9802c769e},
{"S",100,1},
{"D"},
{"N",15,3,0}
},"Значение параметра",28},
{3,"МоментВремениДата",
{"Pattern",
{"D"}
},"Момент времени дата",15},
{4,"МоментВремениСсылка",
{"Pattern",
{"#",38bfd075-3e63-4aaa-a93e-94521380d579}
},"Момент времени ссылка",15},
{5,"ГраницаЗначение",
{"Pattern",
{"#",38bfd075-3e63-4aaa-a93e-94521380d579},
{"D"}
},"Граница значение",15},
{6,"ГраницаВид",
{"Pattern",
{"S"}
},"Граница вид сравнения",15},
{7,"ТаблицаЗначений",
{"Pattern"},"",0}
},
{2,8,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,
{1,3,
{2,0,8,
{"S","ВидДополнительнойАналитикиУУ"},
{"B",0},
{"#",af50d627-2650-4410-aaf0-8cf34c5997bc,12242:9e1af62ce9b4e3534f55bff307437d31},
{"D",00010101000000},
{"U"},
{"U"},
{"S",""},
{"U"},0},
{2,1,8,
{"S","КонецПериода"},
{"B",0},
{"D",20171231000000},
{"D",00010101000000},
{"U"},
{"U"},
{"S",""},
{"U"},0},
{2,2,8,
{"S","НачалоПериода"},
{"B",0},
{"D",20170101000000},
{"D",00010101000000},
{"U"},
{"U"},
{"S",""},
{"U"},0}
},-1,2}
}
},0},
{2,8,3,
{"D",20171101145854},
{"S","ВЫБРАТЬ
	икЗначенияДополнительныхАналитикУУОбъектов.Сотрудник КАК Сотрудник,
	икЗначенияДополнительныхАналитикУУОбъектов.ЗначениеДополнительнойАналитикиУУ,
	икЗначенияДополнительныхАналитикУУОбъектов.Период КАК Период
ПОМЕСТИТЬ ВтАналитики
ИЗ
	РегистрСведений.икЗначенияДополнительныхАналитикУУОбъектов КАК икЗначенияДополнительныхАналитикУУОбъектов
ГДЕ
	икЗначенияДополнительныхАналитикУУОбъектов.ВидДополнительнойАналитикиУУ = &ВидДополнительнойАналитикиУУ
	И икЗначенияДополнительныхАналитикУУОбъектов.Период МЕЖДУ &НачалоПериода И &КонецПериода

ОБЪЕДИНИТЬ

ВЫБРАТЬ
	икЗначенияДополнительныхАналитикУУОбъектовСрезПоследних.Сотрудник,
	икЗначенияДополнительныхАналитикУУОбъектовСрезПоследних.ЗначениеДополнительнойАналитикиУУ,
	&НачалоПериода
ИЗ
	РегистрСведений.икЗначенияДополнительныхАналитикУУОбъектов.СрезПоследних(&НачалоПериода, ВидДополнительнойАналитикиУУ = &ВидДополнительнойАналитикиУУ) КАК икЗначенияДополнительныхАналитикУУОбъектовСрезПоследних
ГДЕ
	икЗначенияДополнительныхАналитикУУОбъектовСрезПоследних.ВидДополнительнойАналитикиУУ = &ВидДополнительнойАналитикиУУ
	И икЗначенияДополнительныхАналитикУУОбъектовСрезПоследних.Период МЕЖДУ &НачалоПериода И &КонецПериода
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ВтАналитики.Сотрудник КАК Сотрудник,
	ВтАналитики.ЗначениеДополнительнойАналитикиУУ,
	ВтАналитики.Период КАК ПериодНачало,
	ВЫБОР
		КОГДА ВтАналитики1.Период ЕСТЬ NULL 
			ТОГДА КОНЕЦПЕРИОДА(&КонецПериода, МЕСЯЦ)
		ИНАЧЕ ДОБАВИТЬКДАТЕ(ВтАналитики1.Период, ДЕНЬ, -1)
	КОНЕЦ КАК ПериодКонец
ПОМЕСТИТЬ ВтПериоды
ИЗ
	ВтАналитики КАК ВтАналитики
		ЛЕВОЕ СОЕДИНЕНИЕ ВтАналитики КАК ВтАналитики1
		ПО ВтАналитики.Сотрудник = ВтАналитики1.Сотрудник
			И ВтАналитики.Период < ВтАналитики1.Период
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗЛИЧНЫЕ
	НАЧАЛОПЕРИОДА(РегламентированныйПроизводственныйКалендарь.ДатаКалендаря, МЕСЯЦ) КАК Месяц
ПОМЕСТИТЬ ВтМесяцы
ИЗ
	РегистрСведений.РегламентированныйПроизводственныйКалендарь КАК РегламентированныйПроизводственныйКалендарь
ГДЕ
	РегламентированныйПроизводственныйКалендарь.ДатаКалендаря МЕЖДУ &НачалоПериода И &КонецПериода
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ВтПериоды.Сотрудник КАК Сотрудник,
	ВтПериоды.ЗначениеДополнительнойАналитикиУУ,
	ВтПериоды.ПериодНачало,
	ВтПериоды.ПериодКонец,
	ВтМесяцы.Месяц КАК Месяц
ИЗ
	ВтМесяцы КАК ВтМесяцы
		ЛЕВОЕ СОЕДИНЕНИЕ ВтПериоды КАК ВтПериоды
		ПО (ВтМесяцы.Месяц МЕЖДУ ВтПериоды.ПериодНачало И ВтПериоды.ПериодКонец)

УПОРЯДОЧИТЬ ПО
	Месяц,
	Сотрудник"},
{"#",acf6192e-81ca-46ef-93a6-5a6968b78663,
{8,
{8,
{0,"ИмяПараметра",
{"Pattern",
{"S",50,1}
},"Имя параметра",22},
{1,"ЭтоВыражение",
{"Pattern",
{"B"}
},"ЭтоВыражение",0},
{2,"ЗначениеПараметра",
{"Pattern",
{"#",280f5f0e-9c8a-49cc-bf6d-4d296cc17a63},
{"#",4772b3b4-f4a3-49c0-a1a5-8cb5961511a3},
{"#",5a49abd5-936d-4f46-8499-9cb204efe378},
{"B"},
{"#",741ae838-6e42-4ac0-b6a4-17e5604b0669},
{"#",872f7198-7083-4e3e-b57e-a2a9802c769e},
{"S",100,1},
{"D"},
{"N",15,3,0}
},"Значение параметра",28},
{3,"МоментВремениДата",
{"Pattern",
{"D"}
},"Момент времени дата",15},
{4,"МоментВремениСсылка",
{"Pattern",
{"#",38bfd075-3e63-4aaa-a93e-94521380d579}
},"Момент времени ссылка",15},
{5,"ГраницаЗначение",
{"Pattern",
{"#",38bfd075-3e63-4aaa-a93e-94521380d579},
{"D"}
},"Граница значение",15},
{6,"ГраницаВид",
{"Pattern",
{"S"}
},"Граница вид сравнения",15},
{7,"ТаблицаЗначений",
{"Pattern"},"",0}
},
{2,8,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,
{1,3,
{2,0,8,
{"S","ВидДополнительнойАналитикиУУ"},
{"B",0},
{"#",af50d627-2650-4410-aaf0-8cf34c5997bc,12242:9e1af62ce9b4e3534f55bff307437d31},
{"D",00010101000000},
{"U"},
{"U"},
{"S",""},
{"U"},0},
{2,1,8,
{"S","КонецПериода"},
{"B",0},
{"D",20171231000000},
{"D",00010101000000},
{"U"},
{"U"},
{"S",""},
{"U"},0},
{2,2,8,
{"S","НачалоПериода"},
{"B",0},
{"D",20170101000000},
{"D",00010101000000},
{"U"},
{"U"},
{"S",""},
{"U"},0}
},-1,2}
}
},0},
{2,9,3,
{"D",20171101145902},
{"S","ВЫБРАТЬ
	икЗначенияДополнительныхАналитикУУОбъектов.Сотрудник КАК Сотрудник,
	икЗначенияДополнительныхАналитикУУОбъектов.ЗначениеДополнительнойАналитикиУУ,
	икЗначенияДополнительныхАналитикУУОбъектов.Период КАК Период
ПОМЕСТИТЬ ВтАналитики
ИЗ
	РегистрСведений.икЗначенияДополнительныхАналитикУУОбъектов КАК икЗначенияДополнительныхАналитикУУОбъектов
ГДЕ
	икЗначенияДополнительныхАналитикУУОбъектов.ВидДополнительнойАналитикиУУ = &ВидДополнительнойАналитикиУУ
	И икЗначенияДополнительныхАналитикУУОбъектов.Период МЕЖДУ &НачалоПериода И &КонецПериода

ОБЪЕДИНИТЬ

ВЫБРАТЬ
	икЗначенияДополнительныхАналитикУУОбъектовСрезПоследних.Сотрудник,
	икЗначенияДополнительныхАналитикУУОбъектовСрезПоследних.ЗначениеДополнительнойАналитикиУУ,
	&НачалоПериода
ИЗ
	РегистрСведений.икЗначенияДополнительныхАналитикУУОбъектов.СрезПоследних(&НачалоПериода, ВидДополнительнойАналитикиУУ = &ВидДополнительнойАналитикиУУ) КАК икЗначенияДополнительныхАналитикУУОбъектовСрезПоследних
ГДЕ
	икЗначенияДополнительныхАналитикУУОбъектовСрезПоследних.ВидДополнительнойАналитикиУУ = &ВидДополнительнойАналитикиУУ
	И икЗначенияДополнительныхАналитикУУОбъектовСрезПоследних.Период МЕЖДУ &НачалоПериода И &КонецПериода
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ВтАналитики.Сотрудник КАК Сотрудник,
	ВтАналитики.ЗначениеДополнительнойАналитикиУУ,
	ВтАналитики.Период КАК ПериодНачало,
	ВЫБОР
		КОГДА ВтАналитики1.Период ЕСТЬ NULL 
			ТОГДА КОНЕЦПЕРИОДА(&КонецПериода, МЕСЯЦ)
		ИНАЧЕ ДОБАВИТЬКДАТЕ(ВтАналитики1.Период, ДЕНЬ, -1)
	КОНЕЦ КАК ПериодКонец
ПОМЕСТИТЬ ВтПериоды
ИЗ
	ВтАналитики КАК ВтАналитики
		ЛЕВОЕ СОЕДИНЕНИЕ ВтАналитики КАК ВтАналитики1
		ПО ВтАналитики.Сотрудник = ВтАналитики1.Сотрудник
			И ВтАналитики.Период < ВтАналитики1.Период
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗЛИЧНЫЕ
	НАЧАЛОПЕРИОДА(РегламентированныйПроизводственныйКалендарь.ДатаКалендаря, МЕСЯЦ) КАК Месяц
ПОМЕСТИТЬ ВтМесяцы
ИЗ
	РегистрСведений.РегламентированныйПроизводственныйКалендарь КАК РегламентированныйПроизводственныйКалендарь
ГДЕ
	РегламентированныйПроизводственныйКалендарь.ДатаКалендаря МЕЖДУ &НачалоПериода И &КонецПериода
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ВтПериоды.Сотрудник КАК Сотрудник,
	ВтПериоды.ЗначениеДополнительнойАналитикиУУ,
	ВтПериоды.ПериодНачало,
	ВтПериоды.ПериодКонец,
	ВтМесяцы.Месяц КАК Месяц
ИЗ
	ВтМесяцы КАК ВтМесяцы
		ЛЕВОЕ СОЕДИНЕНИЕ ВтПериоды КАК ВтПериоды
		ПО (ВтМесяцы.Месяц МЕЖДУ ВтПериоды.ПериодНачало И ВтПериоды.ПериодКонец)

УПОРЯДОЧИТЬ ПО
	Месяц,
	Сотрудник"},
{"#",acf6192e-81ca-46ef-93a6-5a6968b78663,
{8,
{8,
{0,"ИмяПараметра",
{"Pattern",
{"S",50,1}
},"Имя параметра",22},
{1,"ЭтоВыражение",
{"Pattern",
{"B"}
},"ЭтоВыражение",0},
{2,"ЗначениеПараметра",
{"Pattern",
{"#",280f5f0e-9c8a-49cc-bf6d-4d296cc17a63},
{"#",4772b3b4-f4a3-49c0-a1a5-8cb5961511a3},
{"#",5a49abd5-936d-4f46-8499-9cb204efe378},
{"B"},
{"#",741ae838-6e42-4ac0-b6a4-17e5604b0669},
{"#",872f7198-7083-4e3e-b57e-a2a9802c769e},
{"S",100,1},
{"D"},
{"N",15,3,0}
},"Значение параметра",28},
{3,"МоментВремениДата",
{"Pattern",
{"D"}
},"Момент времени дата",15},
{4,"МоментВремениСсылка",
{"Pattern",
{"#",38bfd075-3e63-4aaa-a93e-94521380d579}
},"Момент времени ссылка",15},
{5,"ГраницаЗначение",
{"Pattern",
{"#",38bfd075-3e63-4aaa-a93e-94521380d579},
{"D"}
},"Граница значение",15},
{6,"ГраницаВид",
{"Pattern",
{"S"}
},"Граница вид сравнения",15},
{7,"ТаблицаЗначений",
{"Pattern"},"",0}
},
{2,8,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,
{1,3,
{2,0,8,
{"S","ВидДополнительнойАналитикиУУ"},
{"B",0},
{"#",af50d627-2650-4410-aaf0-8cf34c5997bc,12242:9e1af62ce9b4e3534f55bff307437d31},
{"D",00010101000000},
{"U"},
{"U"},
{"S",""},
{"U"},0},
{2,1,8,
{"S","КонецПериода"},
{"B",0},
{"D",20171231000000},
{"D",00010101000000},
{"U"},
{"U"},
{"S",""},
{"U"},0},
{2,2,8,
{"S","НачалоПериода"},
{"B",0},
{"D",20170101000000},
{"D",00010101000000},
{"U"},
{"U"},
{"S",""},
{"U"},0}
},-1,2}
}
},0},
{2,10,3,
{"D",20171101150015},
{"S","ВЫБРАТЬ
	икЗначенияДополнительныхАналитикУУОбъектов.Сотрудник КАК Сотрудник,
	икЗначенияДополнительныхАналитикУУОбъектов.ЗначениеДополнительнойАналитикиУУ,
	икЗначенияДополнительныхАналитикУУОбъектов.Период КАК Период
ПОМЕСТИТЬ ВтАналитики
ИЗ
	РегистрСведений.икЗначенияДополнительныхАналитикУУОбъектов КАК икЗначенияДополнительныхАналитикУУОбъектов
ГДЕ
	икЗначенияДополнительныхАналитикУУОбъектов.ВидДополнительнойАналитикиУУ = &ВидДополнительнойАналитикиУУ
	И икЗначенияДополнительныхАналитикУУОбъектов.Период МЕЖДУ &НачалоПериода И &КонецПериода

ОБЪЕДИНИТЬ

ВЫБРАТЬ
	икЗначенияДополнительныхАналитикУУОбъектовСрезПоследних.Сотрудник,
	икЗначенияДополнительныхАналитикУУОбъектовСрезПоследних.ЗначениеДополнительнойАналитикиУУ,
	&НачалоПериода
ИЗ
	РегистрСведений.икЗначенияДополнительныхАналитикУУОбъектов.СрезПоследних(&НачалоПериода, ВидДополнительнойАналитикиУУ = &ВидДополнительнойАналитикиУУ) КАК икЗначенияДополнительныхАналитикУУОбъектовСрезПоследних
ГДЕ
	икЗначенияДополнительныхАналитикУУОбъектовСрезПоследних.ВидДополнительнойАналитикиУУ = &ВидДополнительнойАналитикиУУ
	И икЗначенияДополнительныхАналитикУУОбъектовСрезПоследних.Период МЕЖДУ &НачалоПериода И &КонецПериода
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ВтАналитики.Сотрудник КАК Сотрудник,
	ВтАналитики.ЗначениеДополнительнойАналитикиУУ,
	ВтАналитики.Период КАК ПериодНачало,
	ВЫБОР
		КОГДА ВтАналитики1.Период ЕСТЬ NULL 
			ТОГДА КОНЕЦПЕРИОДА(&КонецПериода, МЕСЯЦ)
		ИНАЧЕ ДОБАВИТЬКДАТЕ(ВтАналитики1.Период, ДЕНЬ, -1)
	КОНЕЦ КАК ПериодКонец
ПОМЕСТИТЬ ВтПериоды
ИЗ
	ВтАналитики КАК ВтАналитики
		ЛЕВОЕ СОЕДИНЕНИЕ ВтАналитики КАК ВтАналитики1
		ПО ВтАналитики.Сотрудник = ВтАналитики1.Сотрудник
			И ВтАналитики.Период < ВтАналитики1.Период
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗЛИЧНЫЕ
	НАЧАЛОПЕРИОДА(РегламентированныйПроизводственныйКалендарь.ДатаКалендаря, МЕСЯЦ) КАК Месяц
ПОМЕСТИТЬ ВтМесяцы
ИЗ
	РегистрСведений.РегламентированныйПроизводственныйКалендарь КАК РегламентированныйПроизводственныйКалендарь
ГДЕ
	РегламентированныйПроизводственныйКалендарь.ДатаКалендаря МЕЖДУ &НачалоПериода И &КонецПериода
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ВтПериоды.Сотрудник КАК Сотрудник,
	ВтПериоды.ЗначениеДополнительнойАналитикиУУ,
	ВтМесяцы.Месяц КАК НачалоПериода,
	КОНЕЦПЕРИОДА(ВтМесяцы.Месяц, МЕСЯЦ) КАК КонецПериода,
	ВтМесяцы.Месяц КАК Месяц
ИЗ
	ВтМесяцы КАК ВтМесяцы
		ЛЕВОЕ СОЕДИНЕНИЕ ВтПериоды КАК ВтПериоды
		ПО (ВтМесяцы.Месяц МЕЖДУ ВтПериоды.ПериодНачало И ВтПериоды.ПериодКонец)

УПОРЯДОЧИТЬ ПО
	Месяц,
	Сотрудник"},
{"#",acf6192e-81ca-46ef-93a6-5a6968b78663,
{8,
{8,
{0,"ИмяПараметра",
{"Pattern",
{"S",50,1}
},"Имя параметра",22},
{1,"ЭтоВыражение",
{"Pattern",
{"B"}
},"ЭтоВыражение",0},
{2,"ЗначениеПараметра",
{"Pattern",
{"#",280f5f0e-9c8a-49cc-bf6d-4d296cc17a63},
{"#",4772b3b4-f4a3-49c0-a1a5-8cb5961511a3},
{"#",5a49abd5-936d-4f46-8499-9cb204efe378},
{"B"},
{"#",741ae838-6e42-4ac0-b6a4-17e5604b0669},
{"#",872f7198-7083-4e3e-b57e-a2a9802c769e},
{"S",100,1},
{"D"},
{"N",15,3,0}
},"Значение параметра",28},
{3,"МоментВремениДата",
{"Pattern",
{"D"}
},"Момент времени дата",15},
{4,"МоментВремениСсылка",
{"Pattern",
{"#",38bfd075-3e63-4aaa-a93e-94521380d579}
},"Момент времени ссылка",15},
{5,"ГраницаЗначение",
{"Pattern",
{"#",38bfd075-3e63-4aaa-a93e-94521380d579},
{"D"}
},"Граница значение",15},
{6,"ГраницаВид",
{"Pattern",
{"S"}
},"Граница вид сравнения",15},
{7,"ТаблицаЗначений",
{"Pattern"},"",0}
},
{2,8,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,
{1,3,
{2,0,8,
{"S","ВидДополнительнойАналитикиУУ"},
{"B",0},
{"#",af50d627-2650-4410-aaf0-8cf34c5997bc,12242:9e1af62ce9b4e3534f55bff307437d31},
{"D",00010101000000},
{"U"},
{"U"},
{"S",""},
{"U"},0},
{2,1,8,
{"S","КонецПериода"},
{"B",0},
{"D",20171231000000},
{"D",00010101000000},
{"U"},
{"U"},
{"S",""},
{"U"},0},
{2,2,8,
{"S","НачалоПериода"},
{"B",0},
{"D",20170101000000},
{"D",00010101000000},
{"U"},
{"U"},
{"S",""},
{"U"},0}
},-1,2}
}
},0},
{2,11,3,
{"D",20171101150033},
{"S","ВЫБРАТЬ
	икЗначенияДополнительныхАналитикУУОбъектов.Сотрудник КАК Сотрудник,
	икЗначенияДополнительныхАналитикУУОбъектов.ЗначениеДополнительнойАналитикиУУ,
	икЗначенияДополнительныхАналитикУУОбъектов.Период КАК Период
ПОМЕСТИТЬ ВтАналитики
ИЗ
	РегистрСведений.икЗначенияДополнительныхАналитикУУОбъектов КАК икЗначенияДополнительныхАналитикУУОбъектов
ГДЕ
	икЗначенияДополнительныхАналитикУУОбъектов.ВидДополнительнойАналитикиУУ = &ВидДополнительнойАналитикиУУ
	И икЗначенияДополнительныхАналитикУУОбъектов.Период МЕЖДУ &НачалоПериода И &КонецПериода

ОБЪЕДИНИТЬ

ВЫБРАТЬ
	икЗначенияДополнительныхАналитикУУОбъектовСрезПоследних.Сотрудник,
	икЗначенияДополнительныхАналитикУУОбъектовСрезПоследних.ЗначениеДополнительнойАналитикиУУ,
	&НачалоПериода
ИЗ
	РегистрСведений.икЗначенияДополнительныхАналитикУУОбъектов.СрезПоследних(&НачалоПериода, ВидДополнительнойАналитикиУУ = &ВидДополнительнойАналитикиУУ) КАК икЗначенияДополнительныхАналитикУУОбъектовСрезПоследних
ГДЕ
	икЗначенияДополнительныхАналитикУУОбъектовСрезПоследних.ВидДополнительнойАналитикиУУ = &ВидДополнительнойАналитикиУУ
	И икЗначенияДополнительныхАналитикУУОбъектовСрезПоследних.Период МЕЖДУ &НачалоПериода И &КонецПериода
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ВтАналитики.Сотрудник КАК Сотрудник,
	ВтАналитики.ЗначениеДополнительнойАналитикиУУ,
	ВтАналитики.Период КАК ПериодНачало,
	ВЫБОР
		КОГДА ВтАналитики1.Период ЕСТЬ NULL 
			ТОГДА КОНЕЦПЕРИОДА(&КонецПериода, МЕСЯЦ)
		ИНАЧЕ ДОБАВИТЬКДАТЕ(ВтАналитики1.Период, ДЕНЬ, -1)
	КОНЕЦ КАК ПериодКонец
ПОМЕСТИТЬ ВтПериоды
ИЗ
	ВтАналитики КАК ВтАналитики
		ЛЕВОЕ СОЕДИНЕНИЕ ВтАналитики КАК ВтАналитики1
		ПО ВтАналитики.Сотрудник = ВтАналитики1.Сотрудник
			И ВтАналитики.Период < ВтАналитики1.Период
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗЛИЧНЫЕ
	НАЧАЛОПЕРИОДА(РегламентированныйПроизводственныйКалендарь.ДатаКалендаря, МЕСЯЦ) КАК Месяц
ПОМЕСТИТЬ ВтМесяцы
ИЗ
	РегистрСведений.РегламентированныйПроизводственныйКалендарь КАК РегламентированныйПроизводственныйКалендарь
ГДЕ
	РегламентированныйПроизводственныйКалендарь.ДатаКалендаря МЕЖДУ &НачалоПериода И &КонецПериода
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ВтПериоды.Сотрудник КАК Сотрудник,
	ВтПериоды.ЗначениеДополнительнойАналитикиУУ,
	ВтМесяцы.Месяц КАК НачалоПериода,
	КОНЕЦПЕРИОДА(ВтМесяцы.Месяц, МЕСЯЦ) КАК КонецПериода,
	ВтМесяцы.Месяц КАК Месяц
ИЗ
	ВтМесяцы КАК ВтМесяцы
		ЛЕВОЕ СОЕДИНЕНИЕ ВтПериоды КАК ВтПериоды
		ПО (ВтМесяцы.Месяц МЕЖДУ ВтПериоды.ПериодНачало И ВтПериоды.ПериодКонец)

УПОРЯДОЧИТЬ ПО
	Сотрудник,
	Месяц"},
{"#",acf6192e-81ca-46ef-93a6-5a6968b78663,
{8,
{8,
{0,"ИмяПараметра",
{"Pattern",
{"S",50,1}
},"Имя параметра",22},
{1,"ЭтоВыражение",
{"Pattern",
{"B"}
},"ЭтоВыражение",0},
{2,"ЗначениеПараметра",
{"Pattern",
{"#",280f5f0e-9c8a-49cc-bf6d-4d296cc17a63},
{"#",4772b3b4-f4a3-49c0-a1a5-8cb5961511a3},
{"#",5a49abd5-936d-4f46-8499-9cb204efe378},
{"B"},
{"#",741ae838-6e42-4ac0-b6a4-17e5604b0669},
{"#",872f7198-7083-4e3e-b57e-a2a9802c769e},
{"S",100,1},
{"D"},
{"N",15,3,0}
},"Значение параметра",28},
{3,"МоментВремениДата",
{"Pattern",
{"D"}
},"Момент времени дата",15},
{4,"МоментВремениСсылка",
{"Pattern",
{"#",38bfd075-3e63-4aaa-a93e-94521380d579}
},"Момент времени ссылка",15},
{5,"ГраницаЗначение",
{"Pattern",
{"#",38bfd075-3e63-4aaa-a93e-94521380d579},
{"D"}
},"Граница значение",15},
{6,"ГраницаВид",
{"Pattern",
{"S"}
},"Граница вид сравнения",15},
{7,"ТаблицаЗначений",
{"Pattern"},"",0}
},
{2,8,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,
{1,3,
{2,0,8,
{"S","ВидДополнительнойАналитикиУУ"},
{"B",0},
{"#",af50d627-2650-4410-aaf0-8cf34c5997bc,12242:9e1af62ce9b4e3534f55bff307437d31},
{"D",00010101000000},
{"U"},
{"U"},
{"S",""},
{"U"},0},
{2,1,8,
{"S","КонецПериода"},
{"B",0},
{"D",20171231000000},
{"D",00010101000000},
{"U"},
{"U"},
{"S",""},
{"U"},0},
{2,2,8,
{"S","НачалоПериода"},
{"B",0},
{"D",20170101000000},
{"D",00010101000000},
{"U"},
{"U"},
{"S",""},
{"U"},0}
},-1,2}
}
},0},
{2,12,3,
{"D",20171101160108},
{"S","ВЫБРАТЬ
	икЗначенияДополнительныхАналитикУУОбъектов.Сотрудник КАК Сотрудник,
	икЗначенияДополнительныхАналитикУУОбъектов.ЗначениеДополнительнойАналитикиУУ,
	икЗначенияДополнительныхАналитикУУОбъектов.Период КАК Период
ПОМЕСТИТЬ ВтИсходная
ИЗ
	РегистрСведений.икЗначенияДополнительныхАналитикУУОбъектов КАК икЗначенияДополнительныхАналитикУУОбъектов
ГДЕ
	икЗначенияДополнительныхАналитикУУОбъектов.ВидДополнительнойАналитикиУУ = &ВидДополнительнойАналитикиУУ
	И икЗначенияДополнительныхАналитикУУОбъектов.Период МЕЖДУ &НачалоПериода И &КонецПериода

ОБЪЕДИНИТЬ

ВЫБРАТЬ
	икЗначенияДополнительныхАналитикУУОбъектовСрезПоследних.Сотрудник,
	икЗначенияДополнительныхАналитикУУОбъектовСрезПоследних.ЗначениеДополнительнойАналитикиУУ,
	&НачалоПериода
ИЗ
	РегистрСведений.икЗначенияДополнительныхАналитикУУОбъектов.СрезПоследних(&НачалоПериода, ВидДополнительнойАналитикиУУ = &ВидДополнительнойАналитикиУУ) КАК икЗначенияДополнительныхАналитикУУОбъектовСрезПоследних
ГДЕ
	икЗначенияДополнительныхАналитикУУОбъектовСрезПоследних.ВидДополнительнойАналитикиУУ = &ВидДополнительнойАналитикиУУ
	И икЗначенияДополнительныхАналитикУУОбъектовСрезПоследних.Период МЕЖДУ &НачалоПериода И &КонецПериода
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ВтИсходная.Сотрудник КАК Сотрудник,
	ВтИсходная.ЗначениеДополнительнойАналитикиУУ,
	ВтИсходная.Период КАК ПериодНачало,
	ВЫБОР
		КОГДА ВтИсходная1.Период ЕСТЬ NULL 
			ТОГДА КОНЕЦПЕРИОДА(&КонецПериода, МЕСЯЦ)
		ИНАЧЕ ДОБАВИТЬКДАТЕ(ВтИсходная1.Период, ДЕНЬ, -1)
	КОНЕЦ КАК ПериодКонец
ПОМЕСТИТЬ ВтПериоды
ИЗ
	ВтИсходная КАК ВтИсходная
		ЛЕВОЕ СОЕДИНЕНИЕ ВтИсходная КАК ВтИсходная1
		ПО ВтИсходная.Сотрудник = ВтИсходная1.Сотрудник
			И ВтИсходная.Период < ВтИсходная1.Период
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗЛИЧНЫЕ
	НАЧАЛОПЕРИОДА(РегламентированныйПроизводственныйКалендарь.ДатаКалендаря, МЕСЯЦ) КАК Месяц
ПОМЕСТИТЬ ВтМесяцы
ИЗ
	РегистрСведений.РегламентированныйПроизводственныйКалендарь КАК РегламентированныйПроизводственныйКалендарь
ГДЕ
	РегламентированныйПроизводственныйКалендарь.ДатаКалендаря МЕЖДУ &НачалоПериода И &КонецПериода
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ВтПериоды.Сотрудник КАК Сотрудник,
	ВтПериоды.ЗначениеДополнительнойАналитикиУУ,
	ВтМесяцы.Месяц КАК НачалоПериода,
	КОНЕЦПЕРИОДА(ВтМесяцы.Месяц, МЕСЯЦ) КАК КонецПериода,
	ВтМесяцы.Месяц КАК Месяц
ИЗ
	ВтМесяцы КАК ВтМесяцы
		ЛЕВОЕ СОЕДИНЕНИЕ ВтПериоды КАК ВтПериоды
		ПО (ВтМесяцы.Месяц МЕЖДУ ВтПериоды.ПериодНачало И ВтПериоды.ПериодКонец)

УПОРЯДОЧИТЬ ПО
	Сотрудник,
	Месяц"},
{"#",acf6192e-81ca-46ef-93a6-5a6968b78663,
{8,
{8,
{0,"ИмяПараметра",
{"Pattern",
{"S",50,1}
},"Имя параметра",22},
{1,"ЭтоВыражение",
{"Pattern",
{"B"}
},"ЭтоВыражение",0},
{2,"ЗначениеПараметра",
{"Pattern",
{"#",280f5f0e-9c8a-49cc-bf6d-4d296cc17a63},
{"#",4772b3b4-f4a3-49c0-a1a5-8cb5961511a3},
{"#",5a49abd5-936d-4f46-8499-9cb204efe378},
{"B"},
{"#",741ae838-6e42-4ac0-b6a4-17e5604b0669},
{"#",872f7198-7083-4e3e-b57e-a2a9802c769e},
{"S",100,1},
{"D"},
{"N",15,3,0}
},"Значение параметра",28},
{3,"МоментВремениДата",
{"Pattern",
{"D"}
},"Момент времени дата",15},
{4,"МоментВремениСсылка",
{"Pattern",
{"#",38bfd075-3e63-4aaa-a93e-94521380d579}
},"Момент времени ссылка",15},
{5,"ГраницаЗначение",
{"Pattern",
{"#",38bfd075-3e63-4aaa-a93e-94521380d579},
{"D"}
},"Граница значение",15},
{6,"ГраницаВид",
{"Pattern",
{"S"}
},"Граница вид сравнения",15},
{7,"ТаблицаЗначений",
{"Pattern"},"",0}
},
{2,8,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,
{1,3,
{2,0,8,
{"S","ВидДополнительнойАналитикиУУ"},
{"B",0},
{"#",af50d627-2650-4410-aaf0-8cf34c5997bc,12242:9e1af62ce9b4e3534f55bff307437d31},
{"D",00010101000000},
{"U"},
{"U"},
{"S",""},
{"U"},0},
{2,1,8,
{"S","КонецПериода"},
{"B",0},
{"D",20171231000000},
{"D",00010101000000},
{"U"},
{"U"},
{"S",""},
{"U"},0},
{2,2,8,
{"S","НачалоПериода"},
{"B",0},
{"D",20170101000000},
{"D",00010101000000},
{"U"},
{"U"},
{"S",""},
{"U"},0}
},-1,2}
}
},0}
},-1,12}
}
},
{"D",20171101160108},
{"U"},0},
{2,1,13,
{"S","ПодразделенияПоМесяцам"},
{"S","ВЫБРАТЬ РАЗЛИЧНЫЕ
	НАЧАЛОПЕРИОДА(РегламентированныйПроизводственныйКалендарь.ДатаКалендаря, МЕСЯЦ) КАК Месяц
ПОМЕСТИТЬ ВтМесяцы
ИЗ
	РегистрСведений.РегламентированныйПроизводственныйКалендарь КАК РегламентированныйПроизводственныйКалендарь
ГДЕ
	РегламентированныйПроизводственныйКалендарь.ДатаКалендаря МЕЖДУ &НачалоПериода И &КонецПериода
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	икЗначенияДополнительныхАналитикУУОбъектов.Сотрудник.Физлицо КАК Сотрудник,
	икЗначенияДополнительныхАналитикУУОбъектов.Период КАК Период,
	икЗначенияДополнительныхАналитикУУОбъектов.ЗначениеДополнительнойАналитикиУУ КАК Значение
ПОМЕСТИТЬ ВтИсходная1
ИЗ
	РегистрСведений.икЗначенияДополнительныхАналитикУУОбъектов КАК икЗначенияДополнительныхАналитикУУОбъектов
ГДЕ
	икЗначенияДополнительныхАналитикУУОбъектов.ВидДополнительнойАналитикиУУ = &КостЦентр
	И икЗначенияДополнительныхАналитикУУОбъектов.Период МЕЖДУ &НачалоПериода И &КонецПериода
	И (икЗначенияДополнительныхАналитикУУОбъектов.Сотрудник.ДатаУвольнения = ДАТАВРЕМЯ(1, 1, 1)
			ИЛИ икЗначенияДополнительныхАналитикУУОбъектов.Сотрудник.ДатаУвольнения > &НачалоПериода)

ОБЪЕДИНИТЬ

ВЫБРАТЬ
	икЗначенияДополнительныхАналитикУУОбъектовСрезПоследних.Сотрудник.Физлицо,
	&НачалоПериода,
	икЗначенияДополнительныхАналитикУУОбъектовСрезПоследних.ЗначениеДополнительнойАналитикиУУ
ИЗ
	РегистрСведений.икЗначенияДополнительныхАналитикУУОбъектов.СрезПоследних(
			&НачалоПериода,
			ВидДополнительнойАналитикиУУ = &КостЦентр
				И (Сотрудник.ДатаУвольнения = ДАТАВРЕМЯ(1, 1, 1)
					ИЛИ Сотрудник.ДатаУвольнения > &НачалоПериода)) КАК икЗначенияДополнительныхАналитикУУОбъектовСрезПоследних
ГДЕ
	(икЗначенияДополнительныхАналитикУУОбъектовСрезПоследних.Сотрудник.ДатаУвольнения = ДАТАВРЕМЯ(1, 1, 1)
			ИЛИ икЗначенияДополнительныхАналитикУУОбъектовСрезПоследних.Сотрудник.ДатаУвольнения > &НачалоПериода)
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ВтКосты.Сотрудник КАК Сотрудник,
	ВтКосты.Период КАК ПериодНачало,
	МИНИМУМ(ВЫБОР
			КОГДА ВтКосты1.Период ЕСТЬ NULL 
				ТОГДА КОНЕЦПЕРИОДА(&КонецПериода, МЕСЯЦ)
			ИНАЧЕ ДОБАВИТЬКДАТЕ(ВтКосты1.Период, ДЕНЬ, -1)
		КОНЕЦ) КАК ПериодКонец,
	ВтКосты.Значение
ПОМЕСТИТЬ ВтПериодыИсходная1
ИЗ
	ВтИсходная1 КАК ВтКосты
		ЛЕВОЕ СОЕДИНЕНИЕ ВтИсходная1 КАК ВтКосты1
		ПО ВтКосты.Сотрудник = ВтКосты1.Сотрудник
			И ВтКосты.Период < ВтКосты1.Период

СГРУППИРОВАТЬ ПО
	ВтКосты.Период,
	ВтКосты.Сотрудник,
	ВтКосты.Значение
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ВтПериодыКосты.Сотрудник КАК Сотрудник,
	ВтМесяцы.Месяц КАК ПериодРегистрации,
	ВтПериодыКосты.Значение
ПОМЕСТИТЬ ВтМесяцаИсходная1
ИЗ
	ВтМесяцы КАК ВтМесяцы
		ЛЕВОЕ СОЕДИНЕНИЕ ВтПериодыИсходная1 КАК ВтПериодыКосты
		ПО (ВтМесяцы.Месяц МЕЖДУ НАЧАЛОПЕРИОДА(ВтПериодыКосты.ПериодНачало, МЕСЯЦ) И КОНЕЦПЕРИОДА(ВтПериодыКосты.ПериодКонец, МЕСЯЦ))
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	икЗначенияДополнительныхАналитикУУОбъектов.Сотрудник.Физлицо КАК Сотрудник,
	икЗначенияДополнительныхАналитикУУОбъектов.Период КАК Период,
	икЗначенияДополнительныхАналитикУУОбъектов.ЗначениеДополнительнойАналитикиУУ КАК Значение
ПОМЕСТИТЬ ВтИсходная2
ИЗ
	РегистрСведений.икЗначенияДополнительныхАналитикУУОбъектов КАК икЗначенияДополнительныхАналитикУУОбъектов
ГДЕ
	икЗначенияДополнительныхАналитикУУОбъектов.ВидДополнительнойАналитикиУУ = &Регион
	И икЗначенияДополнительныхАналитикУУОбъектов.Период МЕЖДУ &НачалоПериода И &КонецПериода
	И (икЗначенияДополнительныхАналитикУУОбъектов.Сотрудник.ДатаУвольнения = ДАТАВРЕМЯ(1, 1, 1)
			ИЛИ икЗначенияДополнительныхАналитикУУОбъектов.Сотрудник.ДатаУвольнения > &НачалоПериода)

ОБЪЕДИНИТЬ

ВЫБРАТЬ
	икЗначенияДополнительныхАналитикУУОбъектовСрезПоследних.Сотрудник.Физлицо,
	&НачалоПериода,
	икЗначенияДополнительныхАналитикУУОбъектовСрезПоследних.ЗначениеДополнительнойАналитикиУУ
ИЗ
	РегистрСведений.икЗначенияДополнительныхАналитикУУОбъектов.СрезПоследних(
			&НачалоПериода,
			ВидДополнительнойАналитикиУУ = &Регион
				И (Сотрудник.ДатаУвольнения = ДАТАВРЕМЯ(1, 1, 1)
					ИЛИ Сотрудник.ДатаУвольнения > &НачалоПериода)) КАК икЗначенияДополнительныхАналитикУУОбъектовСрезПоследних
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ВтИсходная2.Сотрудник КАК Сотрудник,
	ВтИсходная2.Период КАК ПериодНачало,
	МИНИМУМ(ВЫБОР
			КОГДА ВтИсходная21.Период ЕСТЬ NULL 
				ТОГДА КОНЕЦПЕРИОДА(&КонецПериода, МЕСЯЦ)
			ИНАЧЕ ДОБАВИТЬКДАТЕ(ВтИсходная21.Период, ДЕНЬ, -1)
		КОНЕЦ) КАК ПериодКонец,
	ВтИсходная2.Значение
ПОМЕСТИТЬ ВтПериодыИсходная2
ИЗ
	ВтИсходная2 КАК ВтИсходная2
		ЛЕВОЕ СОЕДИНЕНИЕ ВтИсходная2 КАК ВтИсходная21
		ПО ВтИсходная2.Сотрудник = ВтИсходная21.Сотрудник
			И ВтИсходная2.Период < ВтИсходная21.Период

СГРУППИРОВАТЬ ПО
	ВтИсходная2.Период,
	ВтИсходная2.Сотрудник,
	ВтИсходная2.Значение
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ВтПериодыИсходная2.Сотрудник КАК Сотрудник,
	ВтМесяцы.Месяц КАК ПериодРегистрации,
	ВтПериодыИсходная2.Значение
ПОМЕСТИТЬ ВтМесяцаИсходная2
ИЗ
	ВтМесяцы КАК ВтМесяцы
		ЛЕВОЕ СОЕДИНЕНИЕ ВтПериодыИсходная2 КАК ВтПериодыИсходная2
		ПО (ВтМесяцы.Месяц МЕЖДУ НАЧАЛОПЕРИОДА(ВтПериодыИсходная2.ПериодНачало, МЕСЯЦ) И КОНЕЦПЕРИОДА(ВтПериодыИсходная2.ПериодКонец, МЕСЯЦ))
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ЕСТЬNULL(ВтМесяцаИсходная1.Сотрудник, ВтМесяцаИсходная2.Сотрудник) КАК СотрудникФизлицоСсылка,
	ЕСТЬNULL(ВтМесяцаИсходная1.ПериодРегистрации, ВтМесяцаИсходная2.ПериодРегистрации) КАК ПериодРегистрации,
	ВтМесяцаИсходная1.Значение КАК КостЦентр,
	ВтМесяцаИсходная2.Значение КАК Регион
ИЗ
	ВтМесяцаИсходная1 КАК ВтМесяцаИсходная1
		ПОЛНОЕ СОЕДИНЕНИЕ ВтМесяцаИсходная2 КАК ВтМесяцаИсходная2
		ПО ВтМесяцаИсходная1.Сотрудник = ВтМесяцаИсходная2.Сотрудник
			И ВтМесяцаИсходная1.ПериодРегистрации = ВтМесяцаИсходная2.ПериодРегистрации

УПОРЯДОЧИТЬ ПО
	СотрудникФизлицоСсылка,
	ПериодРегистрации"},
{"#",acf6192e-81ca-46ef-93a6-5a6968b78663,
{8,
{8,
{0,"ИмяПараметра",
{"Pattern",
{"S",50,1}
},"Имя параметра",22},
{1,"ЭтоВыражение",
{"Pattern",
{"B"}
},"ЭтоВыражение",0},
{2,"ЗначениеПараметра",
{"Pattern",
{"#",280f5f0e-9c8a-49cc-bf6d-4d296cc17a63},
{"#",4772b3b4-f4a3-49c0-a1a5-8cb5961511a3},
{"#",5a49abd5-936d-4f46-8499-9cb204efe378},
{"B"},
{"#",741ae838-6e42-4ac0-b6a4-17e5604b0669},
{"#",872f7198-7083-4e3e-b57e-a2a9802c769e},
{"S",100,1},
{"D"},
{"N",15,3,0}
},"Значение параметра",28},
{3,"МоментВремениДата",
{"Pattern",
{"D"}
},"Момент времени дата",15},
{4,"МоментВремениСсылка",
{"Pattern",
{"#",38bfd075-3e63-4aaa-a93e-94521380d579}
},"Момент времени ссылка",15},
{5,"ГраницаЗначение",
{"Pattern",
{"#",38bfd075-3e63-4aaa-a93e-94521380d579},
{"D"}
},"Граница значение",15},
{6,"ГраницаВид",
{"Pattern",
{"S"}
},"Граница вид сравнения",15},
{7,"ТаблицаЗначений",
{"Pattern"},"",0}
},
{2,8,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,
{1,4,
{2,0,8,
{"S","КонецПериода"},
{"B",0},
{"D",20171231000000},
{"D",00010101000000},
{"U"},
{"U"},
{"S",""},
{"U"},0},
{2,1,8,
{"S","НачалоПериода"},
{"B",0},
{"D",20170101000000},
{"D",00010101000000},
{"U"},
{"U"},
{"S",""},
{"U"},0},
{2,2,8,
{"S","КостЦентр"},
{"B",0},
{"#",af50d627-2650-4410-aaf0-8cf34c5997bc,12242:9e1af62ce9b4e3534f55bff307437d31},
{"D",00010101000000},
{"U"},
{"U"},
{"S",""},
{"U"},0},
{2,3,8,
{"S","Регион"},
{"B",0},
{"#",af50d627-2650-4410-aaf0-8cf34c5997bc,12242:a176771f44b79071471cfbdf325c78ae},
{"D",00010101000000},
{"U"},
{"U"},
{"S",""},
{"U"},0}
},-1,3}
}
},
{"N",1},
{"B",0},
{"#",acf6192e-81ca-46ef-93a6-5a6968b78663,
{8,
{5,
{0,"Включена",
{"Pattern",
{"B"}
},"Включена",0},
{1,"ТипОбхода",
{"Pattern"},"Тип обхода",19},
{2,"Группировки",
{"Pattern",
{"S"}
},"Группировки",21},
{3,"ГруппировкиДляЗначенийГруппировок",
{"Pattern",
{"S"}
},"Группировки для значений группировок",30},
{4,"Имя",
{"Pattern",
{"S"}
},"Имя выборки",16}
},
{2,5,0,0,1,1,2,2,3,3,4,4,
{1,0},-1,-1}
}
},
{"N",1},
{"B",0},
{"S",""},
{"U"},
{"#",acf6192e-81ca-46ef-93a6-5a6968b78663,
{8,
{3,
{0,"ДатаВерсии",
{"Pattern"},"",0},
{1,"ТекстЗапроса",
{"Pattern"},"",0},
{2,"Параметры",
{"Pattern"},"",0}
},
{2,3,0,0,1,1,2,2,
{1,12,
{2,0,3,
{"D",20171101153305},
{"S","ВЫБРАТЬ
	РаботникиОрганизаций.Сотрудник,
	РаботникиОрганизаций.Период,
	РаботникиОрганизаций.ПодразделениеОрганизации КАК Подразделение
ИЗ
	РегистрСведений.РаботникиОрганизаций КАК РаботникиОрганизаций
ГДЕ
	РаботникиОрганизаций.Организация = &Организация
	И РаботникиОрганизаций.ПериодЗавершения = ДАТАВРЕМЯ(1, 1, 1)
	И РаботникиОрганизаций.Период МЕЖДУ &НачалоПериода И &КонецПериода

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	РаботникиОрганизаций.Сотрудник,
	РаботникиОрганизаций.Период,
	РаботникиОрганизаций.ПодразделениеОрганизацииЗавершения
ИЗ
	РегистрСведений.РаботникиОрганизаций КАК РаботникиОрганизаций
ГДЕ
	РаботникиОрганизаций.Организация = &Организация
	И РаботникиОрганизаций.ПериодЗавершения МЕЖДУ &НачалоПериода И &КонецПериода

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	РаботникиОрганизацийСрезПоследних.Сотрудник,
	РаботникиОрганизацийСрезПоследних.Период,
	&НачалоПериода
ИЗ
	РегистрСведений.РаботникиОрганизаций.СрезПоследних(&НачалоПериода, Организация = &Организация) КАК РаботникиОрганизацийСрезПоследних
ГДЕ
	РаботникиОрганизацийСрезПоследних.Организация = &Организация
	И РаботникиОрганизацийСрезПоследних.ПериодЗавершения = ДАТАВРЕМЯ(1, 1, 1)
	И РаботникиОрганизацийСрезПоследних.Период МЕЖДУ &НачалоПериода И &КонецПериода"},
{"#",acf6192e-81ca-46ef-93a6-5a6968b78663,
{8,
{8,
{0,"ИмяПараметра",
{"Pattern",
{"S",50,1}
},"Имя параметра",22},
{1,"ЭтоВыражение",
{"Pattern",
{"B"}
},"ЭтоВыражение",0},
{2,"ЗначениеПараметра",
{"Pattern",
{"#",280f5f0e-9c8a-49cc-bf6d-4d296cc17a63},
{"#",4772b3b4-f4a3-49c0-a1a5-8cb5961511a3},
{"#",5a49abd5-936d-4f46-8499-9cb204efe378},
{"B"},
{"#",741ae838-6e42-4ac0-b6a4-17e5604b0669},
{"#",872f7198-7083-4e3e-b57e-a2a9802c769e},
{"S",100,1},
{"D"},
{"N",15,3,0}
},"Значение параметра",28},
{3,"МоментВремениДата",
{"Pattern",
{"D"}
},"Момент времени дата",15},
{4,"МоментВремениСсылка",
{"Pattern",
{"#",38bfd075-3e63-4aaa-a93e-94521380d579}
},"Момент времени ссылка",15},
{5,"ГраницаЗначение",
{"Pattern",
{"#",38bfd075-3e63-4aaa-a93e-94521380d579},
{"D"}
},"Граница значение",15},
{6,"ГраницаВид",
{"Pattern",
{"S"}
},"Граница вид сравнения",15},
{7,"ТаблицаЗначений",
{"Pattern"},"",0}
},
{2,8,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,
{1,3,
{2,0,8,
{"S","КонецПериода"},
{"B",0},
{"D",20171231000000},
{"D",00010101000000},
{"U"},
{"U"},
{"S",""},
{"U"},0},
{2,1,8,
{"S","НачалоПериода"},
{"B",0},
{"D",20170101000000},
{"D",00010101000000},
{"U"},
{"U"},
{"S",""},
{"U"},0},
{2,2,8,
{"S","Организация"},
{"B",0},
{"#",99a69cd8-ab6b-4aa6-8475-1fe937dc6241,103:8f1b00155d329d3111e71203a815385f},
{"D",00010101000000},
{"U"},
{"U"},
{"S",""},
{"U"},0}
},-1,2}
}
},0},
{2,1,3,
{"D",20171101153326},
{"S","ВЫБРАТЬ
	РаботникиОрганизаций.Сотрудник КАК Сотрудник,
	РаботникиОрганизаций.Период КАК Период,
	РаботникиОрганизаций.ПодразделениеОрганизации КАК Подразделение
ИЗ
	РегистрСведений.РаботникиОрганизаций КАК РаботникиОрганизаций
ГДЕ
	РаботникиОрганизаций.Организация = &Организация
	И РаботникиОрганизаций.ПериодЗавершения = ДАТАВРЕМЯ(1, 1, 1)
	И РаботникиОрганизаций.Период МЕЖДУ &НачалоПериода И &КонецПериода

ОБЪЕДИНИТЬ

ВЫБРАТЬ
	РаботникиОрганизаций.Сотрудник,
	РаботникиОрганизаций.Период,
	РаботникиОрганизаций.ПодразделениеОрганизацииЗавершения
ИЗ
	РегистрСведений.РаботникиОрганизаций КАК РаботникиОрганизаций
ГДЕ
	РаботникиОрганизаций.Организация = &Организация
	И РаботникиОрганизаций.ПериодЗавершения МЕЖДУ &НачалоПериода И &КонецПериода

ОБЪЕДИНИТЬ

ВЫБРАТЬ
	РаботникиОрганизацийСрезПоследних.Сотрудник,
	РаботникиОрганизацийСрезПоследних.Период,
	&НачалоПериода
ИЗ
	РегистрСведений.РаботникиОрганизаций.СрезПоследних(&НачалоПериода, Организация = &Организация) КАК РаботникиОрганизацийСрезПоследних
ГДЕ
	РаботникиОрганизацийСрезПоследних.Организация = &Организация
	И РаботникиОрганизацийСрезПоследних.ПериодЗавершения = ДАТАВРЕМЯ(1, 1, 1)
	И РаботникиОрганизацийСрезПоследних.Период МЕЖДУ &НачалоПериода И &КонецПериода

УПОРЯДОЧИТЬ ПО
	Сотрудник,
	Период"},
{"#",acf6192e-81ca-46ef-93a6-5a6968b78663,
{8,
{8,
{0,"ИмяПараметра",
{"Pattern",
{"S",50,1}
},"Имя параметра",22},
{1,"ЭтоВыражение",
{"Pattern",
{"B"}
},"ЭтоВыражение",0},
{2,"ЗначениеПараметра",
{"Pattern",
{"#",280f5f0e-9c8a-49cc-bf6d-4d296cc17a63},
{"#",4772b3b4-f4a3-49c0-a1a5-8cb5961511a3},
{"#",5a49abd5-936d-4f46-8499-9cb204efe378},
{"B"},
{"#",741ae838-6e42-4ac0-b6a4-17e5604b0669},
{"#",872f7198-7083-4e3e-b57e-a2a9802c769e},
{"S",100,1},
{"D"},
{"N",15,3,0}
},"Значение параметра",28},
{3,"МоментВремениДата",
{"Pattern",
{"D"}
},"Момент времени дата",15},
{4,"МоментВремениСсылка",
{"Pattern",
{"#",38bfd075-3e63-4aaa-a93e-94521380d579}
},"Момент времени ссылка",15},
{5,"ГраницаЗначение",
{"Pattern",
{"#",38bfd075-3e63-4aaa-a93e-94521380d579},
{"D"}
},"Граница значение",15},
{6,"ГраницаВид",
{"Pattern",
{"S"}
},"Граница вид сравнения",15},
{7,"ТаблицаЗначений",
{"Pattern"},"",0}
},
{2,8,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,
{1,3,
{2,0,8,
{"S","КонецПериода"},
{"B",0},
{"D",20171231000000},
{"D",00010101000000},
{"U"},
{"U"},
{"S",""},
{"U"},0},
{2,1,8,
{"S","НачалоПериода"},
{"B",0},
{"D",20170101000000},
{"D",00010101000000},
{"U"},
{"U"},
{"S",""},
{"U"},0},
{2,2,8,
{"S","Организация"},
{"B",0},
{"#",99a69cd8-ab6b-4aa6-8475-1fe937dc6241,103:8f1b00155d329d3111e71203a815385f},
{"D",00010101000000},
{"U"},
{"U"},
{"S",""},
{"U"},0}
},-1,2}
}
},0},
{2,2,3,
{"D",20171101153352},
{"S","ВЫБРАТЬ
	РаботникиОрганизаций.Сотрудник КАК Сотрудник,
	РаботникиОрганизаций.Период КАК Период,
	РаботникиОрганизаций.ПодразделениеОрганизации КАК Подразделение
ИЗ
	РегистрСведений.РаботникиОрганизаций КАК РаботникиОрганизаций
ГДЕ
	РаботникиОрганизаций.Организация = &Организация
	И РаботникиОрганизаций.ПериодЗавершения = ДАТАВРЕМЯ(1, 1, 1)
	И РаботникиОрганизаций.Период МЕЖДУ &НачалоПериода И &КонецПериода

ОБЪЕДИНИТЬ

ВЫБРАТЬ
	РаботникиОрганизаций.Сотрудник,
	РаботникиОрганизаций.Период,
	РаботникиОрганизаций.ПодразделениеОрганизацииЗавершения
ИЗ
	РегистрСведений.РаботникиОрганизаций КАК РаботникиОрганизаций
ГДЕ
	РаботникиОрганизаций.Организация = &Организация
	И РаботникиОрганизаций.ПериодЗавершения МЕЖДУ &НачалоПериода И &КонецПериода

ОБЪЕДИНИТЬ

ВЫБРАТЬ
	РаботникиОрганизацийСрезПоследних.Сотрудник,
	&НачалоПериода,
	РаботникиОрганизацийСрезПоследних.ПодразделениеОрганизации
ИЗ
	РегистрСведений.РаботникиОрганизаций.СрезПоследних(&НачалоПериода, Организация = &Организация) КАК РаботникиОрганизацийСрезПоследних
ГДЕ
	РаботникиОрганизацийСрезПоследних.Организация = &Организация
	И РаботникиОрганизацийСрезПоследних.ПериодЗавершения = ДАТАВРЕМЯ(1, 1, 1)
	И РаботникиОрганизацийСрезПоследних.Период МЕЖДУ &НачалоПериода И &КонецПериода

УПОРЯДОЧИТЬ ПО
	Сотрудник,
	Период"},
{"#",acf6192e-81ca-46ef-93a6-5a6968b78663,
{8,
{8,
{0,"ИмяПараметра",
{"Pattern",
{"S",50,1}
},"Имя параметра",22},
{1,"ЭтоВыражение",
{"Pattern",
{"B"}
},"ЭтоВыражение",0},
{2,"ЗначениеПараметра",
{"Pattern",
{"#",280f5f0e-9c8a-49cc-bf6d-4d296cc17a63},
{"#",4772b3b4-f4a3-49c0-a1a5-8cb5961511a3},
{"#",5a49abd5-936d-4f46-8499-9cb204efe378},
{"B"},
{"#",741ae838-6e42-4ac0-b6a4-17e5604b0669},
{"#",872f7198-7083-4e3e-b57e-a2a9802c769e},
{"S",100,1},
{"D"},
{"N",15,3,0}
},"Значение параметра",28},
{3,"МоментВремениДата",
{"Pattern",
{"D"}
},"Момент времени дата",15},
{4,"МоментВремениСсылка",
{"Pattern",
{"#",38bfd075-3e63-4aaa-a93e-94521380d579}
},"Момент времени ссылка",15},
{5,"ГраницаЗначение",
{"Pattern",
{"#",38bfd075-3e63-4aaa-a93e-94521380d579},
{"D"}
},"Граница значение",15},
{6,"ГраницаВид",
{"Pattern",
{"S"}
},"Граница вид сравнения",15},
{7,"ТаблицаЗначений",
{"Pattern"},"",0}
},
{2,8,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,
{1,3,
{2,0,8,
{"S","КонецПериода"},
{"B",0},
{"D",20171231000000},
{"D",00010101000000},
{"U"},
{"U"},
{"S",""},
{"U"},0},
{2,1,8,
{"S","НачалоПериода"},
{"B",0},
{"D",20170101000000},
{"D",00010101000000},
{"U"},
{"U"},
{"S",""},
{"U"},0},
{2,2,8,
{"S","Организация"},
{"B",0},
{"#",99a69cd8-ab6b-4aa6-8475-1fe937dc6241,103:8f1b00155d329d3111e71203a815385f},
{"D",00010101000000},
{"U"},
{"U"},
{"S",""},
{"U"},0}
},-1,2}
}
},0},
{2,3,3,
{"D",20171101153420},
{"S","ВЫБРАТЬ
	РаботникиОрганизаций.Сотрудник КАК Сотрудник,
	РаботникиОрганизаций.Период КАК Период,
	РаботникиОрганизаций.ПодразделениеОрганизации КАК Подразделение
ИЗ
	РегистрСведений.РаботникиОрганизаций КАК РаботникиОрганизаций
ГДЕ
	РаботникиОрганизаций.Организация = &Организация
	И РаботникиОрганизаций.ПериодЗавершения = ДАТАВРЕМЯ(1, 1, 1)
	И РаботникиОрганизаций.Период МЕЖДУ &НачалоПериода И &КонецПериода

ОБЪЕДИНИТЬ

ВЫБРАТЬ
	РаботникиОрганизаций.Сотрудник,
	РаботникиОрганизаций.Период,
	РаботникиОрганизаций.ПодразделениеОрганизацииЗавершения
ИЗ
	РегистрСведений.РаботникиОрганизаций КАК РаботникиОрганизаций
ГДЕ
	РаботникиОрганизаций.Организация = &Организация
	И РаботникиОрганизаций.ПериодЗавершения МЕЖДУ &НачалоПериода И &КонецПериода

ОБЪЕДИНИТЬ

ВЫБРАТЬ
	РаботникиОрганизацийСрезПоследних.Сотрудник,
	&НачалоПериода,
	РаботникиОрганизацийСрезПоследних.ПодразделениеОрганизации
ИЗ
	РегистрСведений.РаботникиОрганизаций.СрезПоследних(&НачалоПериода, Организация = &Организация) КАК РаботникиОрганизацийСрезПоследних

УПОРЯДОЧИТЬ ПО
	Сотрудник,
	Период"},
{"#",acf6192e-81ca-46ef-93a6-5a6968b78663,
{8,
{8,
{0,"ИмяПараметра",
{"Pattern",
{"S",50,1}
},"Имя параметра",22},
{1,"ЭтоВыражение",
{"Pattern",
{"B"}
},"ЭтоВыражение",0},
{2,"ЗначениеПараметра",
{"Pattern",
{"#",280f5f0e-9c8a-49cc-bf6d-4d296cc17a63},
{"#",4772b3b4-f4a3-49c0-a1a5-8cb5961511a3},
{"#",5a49abd5-936d-4f46-8499-9cb204efe378},
{"B"},
{"#",741ae838-6e42-4ac0-b6a4-17e5604b0669},
{"#",872f7198-7083-4e3e-b57e-a2a9802c769e},
{"S",100,1},
{"D"},
{"N",15,3,0}
},"Значение параметра",28},
{3,"МоментВремениДата",
{"Pattern",
{"D"}
},"Момент времени дата",15},
{4,"МоментВремениСсылка",
{"Pattern",
{"#",38bfd075-3e63-4aaa-a93e-94521380d579}
},"Момент времени ссылка",15},
{5,"ГраницаЗначение",
{"Pattern",
{"#",38bfd075-3e63-4aaa-a93e-94521380d579},
{"D"}
},"Граница значение",15},
{6,"ГраницаВид",
{"Pattern",
{"S"}
},"Граница вид сравнения",15},
{7,"ТаблицаЗначений",
{"Pattern"},"",0}
},
{2,8,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,
{1,3,
{2,0,8,
{"S","КонецПериода"},
{"B",0},
{"D",20171231000000},
{"D",00010101000000},
{"U"},
{"U"},
{"S",""},
{"U"},0},
{2,1,8,
{"S","НачалоПериода"},
{"B",0},
{"D",20170101000000},
{"D",00010101000000},
{"U"},
{"U"},
{"S",""},
{"U"},0},
{2,2,8,
{"S","Организация"},
{"B",0},
{"#",99a69cd8-ab6b-4aa6-8475-1fe937dc6241,103:8f1b00155d329d3111e71203a815385f},
{"D",00010101000000},
{"U"},
{"U"},
{"S",""},
{"U"},0}
},-1,2}
}
},0},
{2,4,3,
{"D",20171101160228},
{"S","ВЫБРАТЬ
	РаботникиОрганизаций.Сотрудник КАК Сотрудник,
	РаботникиОрганизаций.Период КАК Период,
	РаботникиОрганизаций.ПодразделениеОрганизации КАК Подразделение
ПОМЕСТИТЬ ВтИсходная
ИЗ
	РегистрСведений.РаботникиОрганизаций КАК РаботникиОрганизаций
ГДЕ
	РаботникиОрганизаций.Организация = &Организация
	И РаботникиОрганизаций.ПериодЗавершения = ДАТАВРЕМЯ(1, 1, 1)
	И РаботникиОрганизаций.Период МЕЖДУ &НачалоПериода И &КонецПериода

ОБЪЕДИНИТЬ

ВЫБРАТЬ
	РаботникиОрганизаций.Сотрудник,
	РаботникиОрганизаций.Период,
	РаботникиОрганизаций.ПодразделениеОрганизацииЗавершения
ИЗ
	РегистрСведений.РаботникиОрганизаций КАК РаботникиОрганизаций
ГДЕ
	РаботникиОрганизаций.Организация = &Организация
	И РаботникиОрганизаций.ПериодЗавершения МЕЖДУ &НачалоПериода И &КонецПериода

ОБЪЕДИНИТЬ

ВЫБРАТЬ
	РаботникиОрганизацийСрезПоследних.Сотрудник,
	&НачалоПериода,
	РаботникиОрганизацийСрезПоследних.ПодразделениеОрганизации
ИЗ
	РегистрСведений.РаботникиОрганизаций.СрезПоследних(&НачалоПериода, Организация = &Организация) КАК РаботникиОрганизацийСрезПоследних
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ВтИсходная.Сотрудник КАК Сотрудник,
	ВтИсходная.Подразделение,
	ВтИсходная.Период КАК ПериодНачало,
	ВЫБОР
		КОГДА ВтИсходная1.Период ЕСТЬ NULL 
			ТОГДА КОНЕЦПЕРИОДА(&КонецПериода, МЕСЯЦ)
		ИНАЧЕ ДОБАВИТЬКДАТЕ(ВтИсходная1.Период, ДЕНЬ, -1)
	КОНЕЦ КАК ПериодКонец
ПОМЕСТИТЬ ВтПериоды
ИЗ
	ВтИсходная КАК ВтИсходная
		ЛЕВОЕ СОЕДИНЕНИЕ ВтИсходная КАК ВтИсходная1
		ПО ВтИсходная.Сотрудник = ВтИсходная1.Сотрудник
			И ВтИсходная.Период < ВтИсходная1.Период
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗЛИЧНЫЕ
	НАЧАЛОПЕРИОДА(РегламентированныйПроизводственныйКалендарь.ДатаКалендаря, МЕСЯЦ) КАК Месяц
ПОМЕСТИТЬ ВтМесяцы
ИЗ
	РегистрСведений.РегламентированныйПроизводственныйКалендарь КАК РегламентированныйПроизводственныйКалендарь
ГДЕ
	РегламентированныйПроизводственныйКалендарь.ДатаКалендаря МЕЖДУ &НачалоПериода И &КонецПериода
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ВтПериоды.Сотрудник КАК Сотрудник,
	ВтПериоды.Подразделение,
	ВтМесяцы.Месяц КАК НачалоПериода,
	КОНЕЦПЕРИОДА(ВтМесяцы.Месяц, МЕСЯЦ) КАК КонецПериода,
	ВтМесяцы.Месяц КАК Месяц
ИЗ
	ВтМесяцы КАК ВтМесяцы
		ЛЕВОЕ СОЕДИНЕНИЕ ВтПериоды КАК ВтПериоды
		ПО (ВтМесяцы.Месяц МЕЖДУ ВтПериоды.ПериодНачало И ВтПериоды.ПериодКонец)

УПОРЯДОЧИТЬ ПО
	Сотрудник,
	Месяц"},
{"#",acf6192e-81ca-46ef-93a6-5a6968b78663,
{8,
{8,
{0,"ИмяПараметра",
{"Pattern",
{"S",50,1}
},"Имя параметра",22},
{1,"ЭтоВыражение",
{"Pattern",
{"B"}
},"ЭтоВыражение",0},
{2,"ЗначениеПараметра",
{"Pattern",
{"#",280f5f0e-9c8a-49cc-bf6d-4d296cc17a63},
{"#",4772b3b4-f4a3-49c0-a1a5-8cb5961511a3},
{"#",5a49abd5-936d-4f46-8499-9cb204efe378},
{"B"},
{"#",741ae838-6e42-4ac0-b6a4-17e5604b0669},
{"#",872f7198-7083-4e3e-b57e-a2a9802c769e},
{"S",100,1},
{"D"},
{"N",15,3,0}
},"Значение параметра",28},
{3,"МоментВремениДата",
{"Pattern",
{"D"}
},"Момент времени дата",15},
{4,"МоментВремениСсылка",
{"Pattern",
{"#",38bfd075-3e63-4aaa-a93e-94521380d579}
},"Момент времени ссылка",15},
{5,"ГраницаЗначение",
{"Pattern",
{"#",38bfd075-3e63-4aaa-a93e-94521380d579},
{"D"}
},"Граница значение",15},
{6,"ГраницаВид",
{"Pattern",
{"S"}
},"Граница вид сравнения",15},
{7,"ТаблицаЗначений",
{"Pattern"},"",0}
},
{2,8,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,
{1,3,
{2,0,8,
{"S","КонецПериода"},
{"B",0},
{"D",20171231000000},
{"D",00010101000000},
{"U"},
{"U"},
{"S",""},
{"U"},0},
{2,1,8,
{"S","НачалоПериода"},
{"B",0},
{"D",20170101000000},
{"D",00010101000000},
{"U"},
{"U"},
{"S",""},
{"U"},0},
{2,2,8,
{"S","Организация"},
{"B",0},
{"#",99a69cd8-ab6b-4aa6-8475-1fe937dc6241,103:8f1b00155d329d3111e71203a815385f},
{"D",00010101000000},
{"U"},
{"U"},
{"S",""},
{"U"},0}
},-1,2}
}
},0},
{2,5,3,
{"D",20171101163600},
{"S","ВЫБРАТЬ РАЗЛИЧНЫЕ
	НАЧАЛОПЕРИОДА(РегламентированныйПроизводственныйКалендарь.ДатаКалендаря, МЕСЯЦ) КАК Месяц
ПОМЕСТИТЬ ВтМесяцы
ИЗ
	РегистрСведений.РегламентированныйПроизводственныйКалендарь КАК РегламентированныйПроизводственныйКалендарь
ГДЕ
	РегламентированныйПроизводственныйКалендарь.ДатаКалендаря МЕЖДУ &НачалоПериода И &КонецПериода
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	икЗначенияДополнительныхАналитикУУОбъектов.Сотрудник КАК Сотрудник,
	икЗначенияДополнительныхАналитикУУОбъектов.ЗначениеДополнительнойАналитикиУУ КАК Кост,
	икЗначенияДополнительныхАналитикУУОбъектов.Период КАК Период
ПОМЕСТИТЬ ВтКосты
ИЗ
	РегистрСведений.икЗначенияДополнительныхАналитикУУОбъектов КАК икЗначенияДополнительныхАналитикУУОбъектов
ГДЕ
	икЗначенияДополнительныхАналитикУУОбъектов.ВидДополнительнойАналитикиУУ = &ВидДополнительнойАналитикиУУ
	И икЗначенияДополнительныхАналитикУУОбъектов.Период МЕЖДУ &НачалоПериода И &КонецПериода

ОБЪЕДИНИТЬ

ВЫБРАТЬ
	икЗначенияДополнительныхАналитикУУОбъектовСрезПоследних.Сотрудник,
	икЗначенияДополнительныхАналитикУУОбъектовСрезПоследних.ЗначениеДополнительнойАналитикиУУ,
	&НачалоПериода
ИЗ
	РегистрСведений.икЗначенияДополнительныхАналитикУУОбъектов.СрезПоследних(&НачалоПериода, ВидДополнительнойАналитикиУУ = &ВидДополнительнойАналитикиУУ) КАК икЗначенияДополнительныхАналитикУУОбъектовСрезПоследних
ГДЕ
	икЗначенияДополнительныхАналитикУУОбъектовСрезПоследних.ВидДополнительнойАналитикиУУ = &ВидДополнительнойАналитикиУУ
	И икЗначенияДополнительныхАналитикУУОбъектовСрезПоследних.Период МЕЖДУ &НачалоПериода И &КонецПериода
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	РаботникиОрганизаций.Сотрудник КАК Сотрудник,
	РаботникиОрганизаций.Период КАК Период,
	РаботникиОрганизаций.ПодразделениеОрганизации КАК Подразделение
ПОМЕСТИТЬ ВтПодразделения
ИЗ
	РегистрСведений.РаботникиОрганизаций КАК РаботникиОрганизаций
ГДЕ
	РаботникиОрганизаций.Организация = &Организация
	И РаботникиОрганизаций.ПериодЗавершения = ДАТАВРЕМЯ(1, 1, 1)
	И РаботникиОрганизаций.Период МЕЖДУ &НачалоПериода И &КонецПериода

ОБЪЕДИНИТЬ

ВЫБРАТЬ
	РаботникиОрганизаций.Сотрудник,
	РаботникиОрганизаций.Период,
	РаботникиОрганизаций.ПодразделениеОрганизацииЗавершения
ИЗ
	РегистрСведений.РаботникиОрганизаций КАК РаботникиОрганизаций
ГДЕ
	РаботникиОрганизаций.Организация = &Организация
	И РаботникиОрганизаций.ПериодЗавершения МЕЖДУ &НачалоПериода И &КонецПериода

ОБЪЕДИНИТЬ

ВЫБРАТЬ
	РаботникиОрганизацийСрезПоследних.Сотрудник,
	&НачалоПериода,
	РаботникиОрганизацийСрезПоследних.ПодразделениеОрганизации
ИЗ
	РегистрСведений.РаботникиОрганизаций.СрезПоследних(&НачалоПериода, Организация = &Организация) КАК РаботникиОрганизацийСрезПоследних
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ВтПодразделения.Сотрудник КАК Сотрудник,
	ВтПодразделения.Подразделение,
	ВтПодразделения.Период КАК ПериодНачало,
	МИНИМУМ(ВЫБОР
			КОГДА ВтПодразделения1.Период ЕСТЬ NULL 
				ТОГДА КОНЕЦПЕРИОДА(&КонецПериода, МЕСЯЦ)
			ИНАЧЕ ДОБАВИТЬКДАТЕ(ВтПодразделения1.Период, ДЕНЬ, -1)
		КОНЕЦ) КАК ПериодКонец
ПОМЕСТИТЬ ВтПериодыПодразделения
ИЗ
	ВтПодразделения КАК ВтПодразделения
		ЛЕВОЕ СОЕДИНЕНИЕ ВтПодразделения КАК ВтПодразделения1
		ПО ВтПодразделения.Сотрудник = ВтПодразделения1.Сотрудник
			И ВтПодразделения.Период < ВтПодразделения1.Период

СГРУППИРОВАТЬ ПО
	ВтПодразделения.Период,
	ВтПодразделения.Сотрудник,
	ВтПодразделения.Подразделение
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ВтКосты.Сотрудник КАК Сотрудник,
	ВтКосты.Период КАК ПериодНачало,
	МИНИМУМ(ВЫБОР
			КОГДА ВтКосты1.Период ЕСТЬ NULL 
				ТОГДА КОНЕЦПЕРИОДА(&КонецПериода, МЕСЯЦ)
			ИНАЧЕ ДОБАВИТЬКДАТЕ(ВтКосты1.Период, ДЕНЬ, -1)
		КОНЕЦ) КАК ПериодКонец,
	ВтКосты.Кост
ПОМЕСТИТЬ ВтПериодыКосты
ИЗ
	ВтКосты КАК ВтКосты
		ЛЕВОЕ СОЕДИНЕНИЕ ВтКосты КАК ВтКосты1
		ПО ВтКосты.Сотрудник = ВтКосты1.Сотрудник
			И ВтКосты.Период < ВтКосты1.Период

СГРУППИРОВАТЬ ПО
	ВтКосты.Период,
	ВтКосты.Сотрудник,
	ВтКосты.Кост
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ВтПериодыПодразделения.Сотрудник КАК Сотрудник,
	ВтПериодыПодразделения.Подразделение,
	ВтМесяцы.Месяц КАК НачалоПериода
ПОМЕСТИТЬ ВтПодразделенияПоМесяцам
ИЗ
	ВтМесяцы КАК ВтМесяцы
		ЛЕВОЕ СОЕДИНЕНИЕ ВтПериодыПодразделения КАК ВтПериодыПодразделения
		ПО (ВтМесяцы.Месяц МЕЖДУ ВтПериодыПодразделения.ПериодНачало И ВтПериодыПодразделения.ПериодКонец)
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ВтПериодыКосты.Сотрудник КАК Сотрудник,
	ВтМесяцы.Месяц КАК НачалоПериода,
	ВтПериодыКосты.Кост
ПОМЕСТИТЬ ВтКостыПоМесяцам
ИЗ
	ВтМесяцы КАК ВтМесяцы
		ЛЕВОЕ СОЕДИНЕНИЕ ВтПериодыКосты КАК ВтПериодыКосты
		ПО (ВтМесяцы.Месяц МЕЖДУ ВтПериодыКосты.ПериодНачало И ВтПериодыКосты.ПериодКонец)
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ЕСТЬNULL(ВтКостыПоМесяцам.Сотрудник, ВтПодразделенияПоМесяцам.Сотрудник) КАК Сотрудник,
	ЕСТЬNULL(ВтКостыПоМесяцам.НачалоПериода, ВтПодразделенияПоМесяцам.НачалоПериода) КАК Месяц,
	ВтКостыПоМесяцам.Кост,
	ВтПодразделенияПоМесяцам.Подразделение
ИЗ
	ВтПодразделенияПоМесяцам КАК ВтПодразделенияПоМесяцам
		ПОЛНОЕ СОЕДИНЕНИЕ ВтКостыПоМесяцам КАК ВтКостыПоМесяцам
		ПО ВтПодразделенияПоМесяцам.Сотрудник = ВтКостыПоМесяцам.Сотрудник
			И ВтПодразделенияПоМесяцам.НачалоПериода = ВтКостыПоМесяцам.НачалоПериода"},
{"#",acf6192e-81ca-46ef-93a6-5a6968b78663,
{8,
{8,
{0,"ИмяПараметра",
{"Pattern",
{"S",50,1}
},"Имя параметра",22},
{1,"ЭтоВыражение",
{"Pattern",
{"B"}
},"ЭтоВыражение",0},
{2,"ЗначениеПараметра",
{"Pattern",
{"#",280f5f0e-9c8a-49cc-bf6d-4d296cc17a63},
{"#",4772b3b4-f4a3-49c0-a1a5-8cb5961511a3},
{"#",5a49abd5-936d-4f46-8499-9cb204efe378},
{"B"},
{"#",741ae838-6e42-4ac0-b6a4-17e5604b0669},
{"#",872f7198-7083-4e3e-b57e-a2a9802c769e},
{"S",100,1},
{"D"},
{"N",15,3,0}
},"Значение параметра",28},
{3,"МоментВремениДата",
{"Pattern",
{"D"}
},"Момент времени дата",15},
{4,"МоментВремениСсылка",
{"Pattern",
{"#",38bfd075-3e63-4aaa-a93e-94521380d579}
},"Момент времени ссылка",15},
{5,"ГраницаЗначение",
{"Pattern",
{"#",38bfd075-3e63-4aaa-a93e-94521380d579},
{"D"}
},"Граница значение",15},
{6,"ГраницаВид",
{"Pattern",
{"S"}
},"Граница вид сравнения",15},
{7,"ТаблицаЗначений",
{"Pattern"},"",0}
},
{2,8,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,
{1,4,
{2,0,8,
{"S","КонецПериода"},
{"B",0},
{"D",20171231000000},
{"D",00010101000000},
{"U"},
{"U"},
{"S",""},
{"U"},0},
{2,1,8,
{"S","НачалоПериода"},
{"B",0},
{"D",20170101000000},
{"D",00010101000000},
{"U"},
{"U"},
{"S",""},
{"U"},0},
{2,2,8,
{"S","Организация"},
{"B",0},
{"#",99a69cd8-ab6b-4aa6-8475-1fe937dc6241,103:8f1b00155d329d3111e71203a815385f},
{"D",00010101000000},
{"U"},
{"U"},
{"S",""},
{"U"},0},
{2,3,8,
{"S","ВидДополнительнойАналитикиУУ"},
{"B",0},
{"U"},
{"D",00010101000000},
{"U"},
{"U"},
{"S",""},
{"U"},0}
},-1,3}
}
},0},
{2,6,3,
{"D",20171101163607},
{"S","ВЫБРАТЬ РАЗЛИЧНЫЕ
	НАЧАЛОПЕРИОДА(РегламентированныйПроизводственныйКалендарь.ДатаКалендаря, МЕСЯЦ) КАК Месяц
ПОМЕСТИТЬ ВтМесяцы
ИЗ
	РегистрСведений.РегламентированныйПроизводственныйКалендарь КАК РегламентированныйПроизводственныйКалендарь
ГДЕ
	РегламентированныйПроизводственныйКалендарь.ДатаКалендаря МЕЖДУ &НачалоПериода И &КонецПериода
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	икЗначенияДополнительныхАналитикУУОбъектов.Сотрудник КАК Сотрудник,
	икЗначенияДополнительныхАналитикУУОбъектов.ЗначениеДополнительнойАналитикиУУ КАК Кост,
	икЗначенияДополнительныхАналитикУУОбъектов.Период КАК Период
ПОМЕСТИТЬ ВтКосты
ИЗ
	РегистрСведений.икЗначенияДополнительныхАналитикУУОбъектов КАК икЗначенияДополнительныхАналитикУУОбъектов
ГДЕ
	икЗначенияДополнительныхАналитикУУОбъектов.ВидДополнительнойАналитикиУУ = &ВидДополнительнойАналитикиУУ
	И икЗначенияДополнительныхАналитикУУОбъектов.Период МЕЖДУ &НачалоПериода И &КонецПериода

ОБЪЕДИНИТЬ

ВЫБРАТЬ
	икЗначенияДополнительныхАналитикУУОбъектовСрезПоследних.Сотрудник,
	икЗначенияДополнительныхАналитикУУОбъектовСрезПоследних.ЗначениеДополнительнойАналитикиУУ,
	&НачалоПериода
ИЗ
	РегистрСведений.икЗначенияДополнительныхАналитикУУОбъектов.СрезПоследних(&НачалоПериода, ВидДополнительнойАналитикиУУ = &ВидДополнительнойАналитикиУУ) КАК икЗначенияДополнительныхАналитикУУОбъектовСрезПоследних
ГДЕ
	икЗначенияДополнительныхАналитикУУОбъектовСрезПоследних.ВидДополнительнойАналитикиУУ = &ВидДополнительнойАналитикиУУ
	И икЗначенияДополнительныхАналитикУУОбъектовСрезПоследних.Период МЕЖДУ &НачалоПериода И &КонецПериода
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	РаботникиОрганизаций.Сотрудник КАК Сотрудник,
	РаботникиОрганизаций.Период КАК Период,
	РаботникиОрганизаций.ПодразделениеОрганизации КАК Подразделение
ПОМЕСТИТЬ ВтПодразделения
ИЗ
	РегистрСведений.РаботникиОрганизаций КАК РаботникиОрганизаций
ГДЕ
	РаботникиОрганизаций.Организация = &Организация
	И РаботникиОрганизаций.ПериодЗавершения = ДАТАВРЕМЯ(1, 1, 1)
	И РаботникиОрганизаций.Период МЕЖДУ &НачалоПериода И &КонецПериода

ОБЪЕДИНИТЬ

ВЫБРАТЬ
	РаботникиОрганизаций.Сотрудник,
	РаботникиОрганизаций.Период,
	РаботникиОрганизаций.ПодразделениеОрганизацииЗавершения
ИЗ
	РегистрСведений.РаботникиОрганизаций КАК РаботникиОрганизаций
ГДЕ
	РаботникиОрганизаций.Организация = &Организация
	И РаботникиОрганизаций.ПериодЗавершения МЕЖДУ &НачалоПериода И &КонецПериода

ОБЪЕДИНИТЬ

ВЫБРАТЬ
	РаботникиОрганизацийСрезПоследних.Сотрудник,
	&НачалоПериода,
	РаботникиОрганизацийСрезПоследних.ПодразделениеОрганизации
ИЗ
	РегистрСведений.РаботникиОрганизаций.СрезПоследних(&НачалоПериода, Организация = &Организация) КАК РаботникиОрганизацийСрезПоследних
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ВтПодразделения.Сотрудник КАК Сотрудник,
	ВтПодразделения.Подразделение,
	ВтПодразделения.Период КАК ПериодНачало,
	МИНИМУМ(ВЫБОР
			КОГДА ВтПодразделения1.Период ЕСТЬ NULL 
				ТОГДА КОНЕЦПЕРИОДА(&КонецПериода, МЕСЯЦ)
			ИНАЧЕ ДОБАВИТЬКДАТЕ(ВтПодразделения1.Период, ДЕНЬ, -1)
		КОНЕЦ) КАК ПериодКонец
ПОМЕСТИТЬ ВтПериодыПодразделения
ИЗ
	ВтПодразделения КАК ВтПодразделения
		ЛЕВОЕ СОЕДИНЕНИЕ ВтПодразделения КАК ВтПодразделения1
		ПО ВтПодразделения.Сотрудник = ВтПодразделения1.Сотрудник
			И ВтПодразделения.Период < ВтПодразделения1.Период

СГРУППИРОВАТЬ ПО
	ВтПодразделения.Период,
	ВтПодразделения.Сотрудник,
	ВтПодразделения.Подразделение
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ВтКосты.Сотрудник КАК Сотрудник,
	ВтКосты.Период КАК ПериодНачало,
	МИНИМУМ(ВЫБОР
			КОГДА ВтКосты1.Период ЕСТЬ NULL 
				ТОГДА КОНЕЦПЕРИОДА(&КонецПериода, МЕСЯЦ)
			ИНАЧЕ ДОБАВИТЬКДАТЕ(ВтКосты1.Период, ДЕНЬ, -1)
		КОНЕЦ) КАК ПериодКонец,
	ВтКосты.Кост
ПОМЕСТИТЬ ВтПериодыКосты
ИЗ
	ВтКосты КАК ВтКосты
		ЛЕВОЕ СОЕДИНЕНИЕ ВтКосты КАК ВтКосты1
		ПО ВтКосты.Сотрудник = ВтКосты1.Сотрудник
			И ВтКосты.Период < ВтКосты1.Период

СГРУППИРОВАТЬ ПО
	ВтКосты.Период,
	ВтКосты.Сотрудник,
	ВтКосты.Кост
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ВтПериодыПодразделения.Сотрудник КАК Сотрудник,
	ВтПериодыПодразделения.Подразделение,
	ВтМесяцы.Месяц КАК НачалоПериода
ПОМЕСТИТЬ ВтПодразделенияПоМесяцам
ИЗ
	ВтМесяцы КАК ВтМесяцы
		ЛЕВОЕ СОЕДИНЕНИЕ ВтПериодыПодразделения КАК ВтПериодыПодразделения
		ПО (ВтМесяцы.Месяц МЕЖДУ ВтПериодыПодразделения.ПериодНачало И ВтПериодыПодразделения.ПериодКонец)
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ВтПериодыКосты.Сотрудник КАК Сотрудник,
	ВтМесяцы.Месяц КАК НачалоПериода,
	ВтПериодыКосты.Кост
ПОМЕСТИТЬ ВтКостыПоМесяцам
ИЗ
	ВтМесяцы КАК ВтМесяцы
		ЛЕВОЕ СОЕДИНЕНИЕ ВтПериодыКосты КАК ВтПериодыКосты
		ПО (ВтМесяцы.Месяц МЕЖДУ ВтПериодыКосты.ПериодНачало И ВтПериодыКосты.ПериодКонец)
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ЕСТЬNULL(ВтКостыПоМесяцам.Сотрудник, ВтПодразделенияПоМесяцам.Сотрудник) КАК Сотрудник,
	ЕСТЬNULL(ВтКостыПоМесяцам.НачалоПериода, ВтПодразделенияПоМесяцам.НачалоПериода) КАК Месяц,
	ВтКостыПоМесяцам.Кост,
	ВтПодразделенияПоМесяцам.Подразделение
ИЗ
	ВтПодразделенияПоМесяцам КАК ВтПодразделенияПоМесяцам
		ПОЛНОЕ СОЕДИНЕНИЕ ВтКостыПоМесяцам КАК ВтКостыПоМесяцам
		ПО ВтПодразделенияПоМесяцам.Сотрудник = ВтКостыПоМесяцам.Сотрудник
			И ВтПодразделенияПоМесяцам.НачалоПериода = ВтКостыПоМесяцам.НачалоПериода"},
{"#",acf6192e-81ca-46ef-93a6-5a6968b78663,
{8,
{8,
{0,"ИмяПараметра",
{"Pattern",
{"S",50,1}
},"Имя параметра",22},
{1,"ЭтоВыражение",
{"Pattern",
{"B"}
},"ЭтоВыражение",0},
{2,"ЗначениеПараметра",
{"Pattern",
{"#",280f5f0e-9c8a-49cc-bf6d-4d296cc17a63},
{"#",4772b3b4-f4a3-49c0-a1a5-8cb5961511a3},
{"#",5a49abd5-936d-4f46-8499-9cb204efe378},
{"B"},
{"#",741ae838-6e42-4ac0-b6a4-17e5604b0669},
{"#",872f7198-7083-4e3e-b57e-a2a9802c769e},
{"S",100,1},
{"D"},
{"N",15,3,0}
},"Значение параметра",28},
{3,"МоментВремениДата",
{"Pattern",
{"D"}
},"Момент времени дата",15},
{4,"МоментВремениСсылка",
{"Pattern",
{"#",38bfd075-3e63-4aaa-a93e-94521380d579}
},"Момент времени ссылка",15},
{5,"ГраницаЗначение",
{"Pattern",
{"#",38bfd075-3e63-4aaa-a93e-94521380d579},
{"D"}
},"Граница значение",15},
{6,"ГраницаВид",
{"Pattern",
{"S"}
},"Граница вид сравнения",15},
{7,"ТаблицаЗначений",
{"Pattern"},"",0}
},
{2,8,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,
{1,4,
{2,0,8,
{"S","КонецПериода"},
{"B",0},
{"D",20171231000000},
{"D",00010101000000},
{"U"},
{"U"},
{"S",""},
{"U"},0},
{2,1,8,
{"S","НачалоПериода"},
{"B",0},
{"D",20170101000000},
{"D",00010101000000},
{"U"},
{"U"},
{"S",""},
{"U"},0},
{2,2,8,
{"S","Организация"},
{"B",0},
{"#",99a69cd8-ab6b-4aa6-8475-1fe937dc6241,103:8f1b00155d329d3111e71203a815385f},
{"D",00010101000000},
{"U"},
{"U"},
{"S",""},
{"U"},0},
{2,3,8,
{"S","ВидДополнительнойАналитикиУУ"},
{"B",0},
{"#",af50d627-2650-4410-aaf0-8cf34c5997bc,12242:9e1af62ce9b4e3534f55bff307437d31},
{"D",00010101000000},
{"U"},
{"U"},
{"S",""},
{"U"},0}
},-1,3}
}
},0},
{2,7,3,
{"D",20171101163918},
{"S","ВЫБРАТЬ РАЗЛИЧНЫЕ
	НАЧАЛОПЕРИОДА(РегламентированныйПроизводственныйКалендарь.ДатаКалендаря, МЕСЯЦ) КАК Месяц
ПОМЕСТИТЬ ВтМесяцы
ИЗ
	РегистрСведений.РегламентированныйПроизводственныйКалендарь КАК РегламентированныйПроизводственныйКалендарь
ГДЕ
	РегламентированныйПроизводственныйКалендарь.ДатаКалендаря МЕЖДУ &НачалоПериода И &КонецПериода
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	икЗначенияДополнительныхАналитикУУОбъектов.Сотрудник КАК Сотрудник,
	икЗначенияДополнительныхАналитикУУОбъектов.ЗначениеДополнительнойАналитикиУУ КАК Кост,
	икЗначенияДополнительныхАналитикУУОбъектов.Период КАК Период
ПОМЕСТИТЬ ВтКосты
ИЗ
	РегистрСведений.икЗначенияДополнительныхАналитикУУОбъектов КАК икЗначенияДополнительныхАналитикУУОбъектов
ГДЕ
	икЗначенияДополнительныхАналитикУУОбъектов.ВидДополнительнойАналитикиУУ = &ВидДополнительнойАналитикиУУ
	И икЗначенияДополнительныхАналитикУУОбъектов.Период МЕЖДУ &НачалоПериода И &КонецПериода
	И (икЗначенияДополнительныхАналитикУУОбъектов.Сотрудник.ДатаУвольнения = ДАТАВРЕМЯ(1, 1, 1)
			ИЛИ икЗначенияДополнительныхАналитикУУОбъектов.Сотрудник.ДатаУвольнения > &НачалоПериода)

ОБЪЕДИНИТЬ

ВЫБРАТЬ
	икЗначенияДополнительныхАналитикУУОбъектовСрезПоследних.Сотрудник,
	икЗначенияДополнительныхАналитикУУОбъектовСрезПоследних.ЗначениеДополнительнойАналитикиУУ,
	&НачалоПериода
ИЗ
	РегистрСведений.икЗначенияДополнительныхАналитикУУОбъектов.СрезПоследних(&НачалоПериода, ВидДополнительнойАналитикиУУ = &ВидДополнительнойАналитикиУУ) КАК икЗначенияДополнительныхАналитикУУОбъектовСрезПоследних
ГДЕ
	икЗначенияДополнительныхАналитикУУОбъектовСрезПоследних.ВидДополнительнойАналитикиУУ = &ВидДополнительнойАналитикиУУ
	И икЗначенияДополнительныхАналитикУУОбъектовСрезПоследних.Период МЕЖДУ &НачалоПериода И &КонецПериода
	И (икЗначенияДополнительныхАналитикУУОбъектовСрезПоследних.Сотрудник.ДатаУвольнения = ДАТАВРЕМЯ(1, 1, 1)
			ИЛИ икЗначенияДополнительныхАналитикУУОбъектовСрезПоследних.Сотрудник.ДатаУвольнения > &НачалоПериода)
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	РаботникиОрганизаций.Сотрудник КАК Сотрудник,
	РаботникиОрганизаций.Период КАК Период,
	РаботникиОрганизаций.ПодразделениеОрганизации КАК Подразделение
ПОМЕСТИТЬ ВтПодразделения
ИЗ
	РегистрСведений.РаботникиОрганизаций КАК РаботникиОрганизаций
ГДЕ
	РаботникиОрганизаций.Организация = &Организация
	И РаботникиОрганизаций.ПериодЗавершения = ДАТАВРЕМЯ(1, 1, 1)
	И РаботникиОрганизаций.Период МЕЖДУ &НачалоПериода И &КонецПериода
	И (РаботникиОрганизаций.Сотрудник.ДатаУвольнения = ДАТАВРЕМЯ(1, 1, 1)
			ИЛИ РаботникиОрганизаций.Сотрудник.ДатаУвольнения > &НачалоПериода)

ОБЪЕДИНИТЬ

ВЫБРАТЬ
	РаботникиОрганизаций.Сотрудник,
	РаботникиОрганизаций.Период,
	РаботникиОрганизаций.ПодразделениеОрганизацииЗавершения
ИЗ
	РегистрСведений.РаботникиОрганизаций КАК РаботникиОрганизаций
ГДЕ
	РаботникиОрганизаций.Организация = &Организация
	И РаботникиОрганизаций.ПериодЗавершения МЕЖДУ &НачалоПериода И &КонецПериода
	И (РаботникиОрганизаций.Сотрудник.ДатаУвольнения = ДАТАВРЕМЯ(1, 1, 1)
			ИЛИ РаботникиОрганизаций.Сотрудник.ДатаУвольнения > &НачалоПериода)

ОБЪЕДИНИТЬ

ВЫБРАТЬ
	РаботникиОрганизацийСрезПоследних.Сотрудник,
	&НачалоПериода,
	РаботникиОрганизацийСрезПоследних.ПодразделениеОрганизации
ИЗ
	РегистрСведений.РаботникиОрганизаций.СрезПоследних(
			&НачалоПериода,
			Организация = &Организация
				И (Сотрудник.ДатаУвольнения = ДАТАВРЕМЯ(1, 1, 1)
					ИЛИ Сотрудник.ДатаУвольнения > &НачалоПериода)) КАК РаботникиОрганизацийСрезПоследних
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ВтПодразделения.Сотрудник КАК Сотрудник,
	ВтПодразделения.Подразделение,
	ВтПодразделения.Период КАК ПериодНачало,
	МИНИМУМ(ВЫБОР
			КОГДА ВтПодразделения1.Период ЕСТЬ NULL 
				ТОГДА КОНЕЦПЕРИОДА(&КонецПериода, МЕСЯЦ)
			ИНАЧЕ ДОБАВИТЬКДАТЕ(ВтПодразделения1.Период, ДЕНЬ, -1)
		КОНЕЦ) КАК ПериодКонец
ПОМЕСТИТЬ ВтПериодыПодразделения
ИЗ
	ВтПодразделения КАК ВтПодразделения
		ЛЕВОЕ СОЕДИНЕНИЕ ВтПодразделения КАК ВтПодразделения1
		ПО ВтПодразделения.Сотрудник = ВтПодразделения1.Сотрудник
			И ВтПодразделения.Период < ВтПодразделения1.Период

СГРУППИРОВАТЬ ПО
	ВтПодразделения.Период,
	ВтПодразделения.Сотрудник,
	ВтПодразделения.Подразделение
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ВтКосты.Сотрудник КАК Сотрудник,
	ВтКосты.Период КАК ПериодНачало,
	МИНИМУМ(ВЫБОР
			КОГДА ВтКосты1.Период ЕСТЬ NULL 
				ТОГДА КОНЕЦПЕРИОДА(&КонецПериода, МЕСЯЦ)
			ИНАЧЕ ДОБАВИТЬКДАТЕ(ВтКосты1.Период, ДЕНЬ, -1)
		КОНЕЦ) КАК ПериодКонец,
	ВтКосты.Кост
ПОМЕСТИТЬ ВтПериодыКосты
ИЗ
	ВтКосты КАК ВтКосты
		ЛЕВОЕ СОЕДИНЕНИЕ ВтКосты КАК ВтКосты1
		ПО ВтКосты.Сотрудник = ВтКосты1.Сотрудник
			И ВтКосты.Период < ВтКосты1.Период

СГРУППИРОВАТЬ ПО
	ВтКосты.Период,
	ВтКосты.Сотрудник,
	ВтКосты.Кост
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ВтПериодыПодразделения.Сотрудник КАК Сотрудник,
	ВтПериодыПодразделения.Подразделение,
	ВтМесяцы.Месяц КАК НачалоПериода
ПОМЕСТИТЬ ВтПодразделенияПоМесяцам
ИЗ
	ВтМесяцы КАК ВтМесяцы
		ЛЕВОЕ СОЕДИНЕНИЕ ВтПериодыПодразделения КАК ВтПериодыПодразделения
		ПО (ВтМесяцы.Месяц МЕЖДУ ВтПериодыПодразделения.ПериодНачало И ВтПериодыПодразделения.ПериодКонец)
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ВтПериодыКосты.Сотрудник КАК Сотрудник,
	ВтМесяцы.Месяц КАК НачалоПериода,
	ВтПериодыКосты.Кост
ПОМЕСТИТЬ ВтКостыПоМесяцам
ИЗ
	ВтМесяцы КАК ВтМесяцы
		ЛЕВОЕ СОЕДИНЕНИЕ ВтПериодыКосты КАК ВтПериодыКосты
		ПО (ВтМесяцы.Месяц МЕЖДУ ВтПериодыКосты.ПериодНачало И ВтПериодыКосты.ПериодКонец)
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ЕСТЬNULL(ВтКостыПоМесяцам.Сотрудник, ВтПодразделенияПоМесяцам.Сотрудник) КАК Сотрудник,
	ЕСТЬNULL(ВтКостыПоМесяцам.НачалоПериода, ВтПодразделенияПоМесяцам.НачалоПериода) КАК Месяц,
	ВтКостыПоМесяцам.Кост,
	ВтПодразделенияПоМесяцам.Подразделение
ИЗ
	ВтПодразделенияПоМесяцам КАК ВтПодразделенияПоМесяцам
		ПОЛНОЕ СОЕДИНЕНИЕ ВтКостыПоМесяцам КАК ВтКостыПоМесяцам
		ПО ВтПодразделенияПоМесяцам.Сотрудник = ВтКостыПоМесяцам.Сотрудник
			И ВтПодразделенияПоМесяцам.НачалоПериода = ВтКостыПоМесяцам.НачалоПериода"},
{"#",acf6192e-81ca-46ef-93a6-5a6968b78663,
{8,
{8,
{0,"ИмяПараметра",
{"Pattern",
{"S",50,1}
},"Имя параметра",22},
{1,"ЭтоВыражение",
{"Pattern",
{"B"}
},"ЭтоВыражение",0},
{2,"ЗначениеПараметра",
{"Pattern",
{"#",280f5f0e-9c8a-49cc-bf6d-4d296cc17a63},
{"#",4772b3b4-f4a3-49c0-a1a5-8cb5961511a3},
{"#",5a49abd5-936d-4f46-8499-9cb204efe378},
{"B"},
{"#",741ae838-6e42-4ac0-b6a4-17e5604b0669},
{"#",872f7198-7083-4e3e-b57e-a2a9802c769e},
{"S",100,1},
{"D"},
{"N",15,3,0}
},"Значение параметра",28},
{3,"МоментВремениДата",
{"Pattern",
{"D"}
},"Момент времени дата",15},
{4,"МоментВремениСсылка",
{"Pattern",
{"#",38bfd075-3e63-4aaa-a93e-94521380d579}
},"Момент времени ссылка",15},
{5,"ГраницаЗначение",
{"Pattern",
{"#",38bfd075-3e63-4aaa-a93e-94521380d579},
{"D"}
},"Граница значение",15},
{6,"ГраницаВид",
{"Pattern",
{"S"}
},"Граница вид сравнения",15},
{7,"ТаблицаЗначений",
{"Pattern"},"",0}
},
{2,8,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,
{1,4,
{2,0,8,
{"S","КонецПериода"},
{"B",0},
{"D",20171231000000},
{"D",00010101000000},
{"U"},
{"U"},
{"S",""},
{"U"},0},
{2,1,8,
{"S","НачалоПериода"},
{"B",0},
{"D",20170101000000},
{"D",00010101000000},
{"U"},
{"U"},
{"S",""},
{"U"},0},
{2,2,8,
{"S","Организация"},
{"B",0},
{"#",99a69cd8-ab6b-4aa6-8475-1fe937dc6241,103:8f1b00155d329d3111e71203a815385f},
{"D",00010101000000},
{"U"},
{"U"},
{"S",""},
{"U"},0},
{2,3,8,
{"S","ВидДополнительнойАналитикиУУ"},
{"B",0},
{"#",af50d627-2650-4410-aaf0-8cf34c5997bc,12242:9e1af62ce9b4e3534f55bff307437d31},
{"D",00010101000000},
{"U"},
{"U"},
{"S",""},
{"U"},0}
},-1,3}
}
},0},
{2,8,3,
{"D",20171101163933},
{"S","ВЫБРАТЬ РАЗЛИЧНЫЕ
	НАЧАЛОПЕРИОДА(РегламентированныйПроизводственныйКалендарь.ДатаКалендаря, МЕСЯЦ) КАК Месяц
ПОМЕСТИТЬ ВтМесяцы
ИЗ
	РегистрСведений.РегламентированныйПроизводственныйКалендарь КАК РегламентированныйПроизводственныйКалендарь
ГДЕ
	РегламентированныйПроизводственныйКалендарь.ДатаКалендаря МЕЖДУ &НачалоПериода И &КонецПериода
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	икЗначенияДополнительныхАналитикУУОбъектов.Сотрудник КАК Сотрудник,
	икЗначенияДополнительныхАналитикУУОбъектов.ЗначениеДополнительнойАналитикиУУ КАК Кост,
	икЗначенияДополнительныхАналитикУУОбъектов.Период КАК Период
ПОМЕСТИТЬ ВтКосты
ИЗ
	РегистрСведений.икЗначенияДополнительныхАналитикУУОбъектов КАК икЗначенияДополнительныхАналитикУУОбъектов
ГДЕ
	икЗначенияДополнительныхАналитикУУОбъектов.ВидДополнительнойАналитикиУУ = &ВидДополнительнойАналитикиУУ
	И икЗначенияДополнительныхАналитикУУОбъектов.Период МЕЖДУ &НачалоПериода И &КонецПериода
	И (икЗначенияДополнительныхАналитикУУОбъектов.Сотрудник.ДатаУвольнения = ДАТАВРЕМЯ(1, 1, 1)
			ИЛИ икЗначенияДополнительныхАналитикУУОбъектов.Сотрудник.ДатаУвольнения > &НачалоПериода)

ОБЪЕДИНИТЬ

ВЫБРАТЬ
	икЗначенияДополнительныхАналитикУУОбъектовСрезПоследних.Сотрудник,
	икЗначенияДополнительныхАналитикУУОбъектовСрезПоследних.ЗначениеДополнительнойАналитикиУУ,
	&НачалоПериода
ИЗ
	РегистрСведений.икЗначенияДополнительныхАналитикУУОбъектов.СрезПоследних(&НачалоПериода, ВидДополнительнойАналитикиУУ = &ВидДополнительнойАналитикиУУ) КАК икЗначенияДополнительныхАналитикУУОбъектовСрезПоследних
ГДЕ
	икЗначенияДополнительныхАналитикУУОбъектовСрезПоследних.ВидДополнительнойАналитикиУУ = &ВидДополнительнойАналитикиУУ
	И икЗначенияДополнительныхАналитикУУОбъектовСрезПоследних.Период МЕЖДУ &НачалоПериода И &КонецПериода
	И (икЗначенияДополнительныхАналитикУУОбъектовСрезПоследних.Сотрудник.ДатаУвольнения = ДАТАВРЕМЯ(1, 1, 1)
			ИЛИ икЗначенияДополнительныхАналитикУУОбъектовСрезПоследних.Сотрудник.ДатаУвольнения > &НачалоПериода)
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	РаботникиОрганизаций.Сотрудник КАК Сотрудник,
	РаботникиОрганизаций.Период КАК Период,
	РаботникиОрганизаций.ПодразделениеОрганизации КАК Подразделение
ПОМЕСТИТЬ ВтПодразделения
ИЗ
	РегистрСведений.РаботникиОрганизаций КАК РаботникиОрганизаций
ГДЕ
	РаботникиОрганизаций.Организация = &Организация
	И РаботникиОрганизаций.ПериодЗавершения = ДАТАВРЕМЯ(1, 1, 1)
	И РаботникиОрганизаций.Период МЕЖДУ &НачалоПериода И &КонецПериода
	И (РаботникиОрганизаций.Сотрудник.ДатаУвольнения = ДАТАВРЕМЯ(1, 1, 1)
			ИЛИ РаботникиОрганизаций.Сотрудник.ДатаУвольнения > &НачалоПериода)

ОБЪЕДИНИТЬ

ВЫБРАТЬ
	РаботникиОрганизаций.Сотрудник,
	РаботникиОрганизаций.Период,
	РаботникиОрганизаций.ПодразделениеОрганизацииЗавершения
ИЗ
	РегистрСведений.РаботникиОрганизаций КАК РаботникиОрганизаций
ГДЕ
	РаботникиОрганизаций.Организация = &Организация
	И РаботникиОрганизаций.ПериодЗавершения МЕЖДУ &НачалоПериода И &КонецПериода
	И (РаботникиОрганизаций.Сотрудник.ДатаУвольнения = ДАТАВРЕМЯ(1, 1, 1)
			ИЛИ РаботникиОрганизаций.Сотрудник.ДатаУвольнения > &НачалоПериода)

ОБЪЕДИНИТЬ

ВЫБРАТЬ
	РаботникиОрганизацийСрезПоследних.Сотрудник,
	&НачалоПериода,
	РаботникиОрганизацийСрезПоследних.ПодразделениеОрганизации
ИЗ
	РегистрСведений.РаботникиОрганизаций.СрезПоследних(
			&НачалоПериода,
			Организация = &Организация
				И (Сотрудник.ДатаУвольнения = ДАТАВРЕМЯ(1, 1, 1)
					ИЛИ Сотрудник.ДатаУвольнения > &НачалоПериода)) КАК РаботникиОрганизацийСрезПоследних
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ВтПодразделения.Сотрудник КАК Сотрудник,
	ВтПодразделения.Подразделение,
	ВтПодразделения.Период КАК ПериодНачало,
	МИНИМУМ(ВЫБОР
			КОГДА ВтПодразделения1.Период ЕСТЬ NULL 
				ТОГДА КОНЕЦПЕРИОДА(&КонецПериода, МЕСЯЦ)
			ИНАЧЕ ДОБАВИТЬКДАТЕ(ВтПодразделения1.Период, ДЕНЬ, -1)
		КОНЕЦ) КАК ПериодКонец
ПОМЕСТИТЬ ВтПериодыПодразделения
ИЗ
	ВтПодразделения КАК ВтПодразделения
		ЛЕВОЕ СОЕДИНЕНИЕ ВтПодразделения КАК ВтПодразделения1
		ПО ВтПодразделения.Сотрудник = ВтПодразделения1.Сотрудник
			И ВтПодразделения.Период < ВтПодразделения1.Период

СГРУППИРОВАТЬ ПО
	ВтПодразделения.Период,
	ВтПодразделения.Сотрудник,
	ВтПодразделения.Подразделение
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ВтКосты.Сотрудник КАК Сотрудник,
	ВтКосты.Период КАК ПериодНачало,
	МИНИМУМ(ВЫБОР
			КОГДА ВтКосты1.Период ЕСТЬ NULL 
				ТОГДА КОНЕЦПЕРИОДА(&КонецПериода, МЕСЯЦ)
			ИНАЧЕ ДОБАВИТЬКДАТЕ(ВтКосты1.Период, ДЕНЬ, -1)
		КОНЕЦ) КАК ПериодКонец,
	ВтКосты.Кост
ПОМЕСТИТЬ ВтПериодыКосты
ИЗ
	ВтКосты КАК ВтКосты
		ЛЕВОЕ СОЕДИНЕНИЕ ВтКосты КАК ВтКосты1
		ПО ВтКосты.Сотрудник = ВтКосты1.Сотрудник
			И ВтКосты.Период < ВтКосты1.Период

СГРУППИРОВАТЬ ПО
	ВтКосты.Период,
	ВтКосты.Сотрудник,
	ВтКосты.Кост
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ВтПериодыПодразделения.Сотрудник КАК Сотрудник,
	ВтПериодыПодразделения.Подразделение,
	ВтМесяцы.Месяц КАК НачалоПериода
ПОМЕСТИТЬ ВтПодразделенияПоМесяцам
ИЗ
	ВтМесяцы КАК ВтМесяцы
		ЛЕВОЕ СОЕДИНЕНИЕ ВтПериодыПодразделения КАК ВтПериодыПодразделения
		ПО (ВтМесяцы.Месяц МЕЖДУ ВтПериодыПодразделения.ПериодНачало И ВтПериодыПодразделения.ПериодКонец)
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ВтПериодыКосты.Сотрудник КАК Сотрудник,
	ВтМесяцы.Месяц КАК НачалоПериода,
	ВтПериодыКосты.Кост
ПОМЕСТИТЬ ВтКостыПоМесяцам
ИЗ
	ВтМесяцы КАК ВтМесяцы
		ЛЕВОЕ СОЕДИНЕНИЕ ВтПериодыКосты КАК ВтПериодыКосты
		ПО (ВтМесяцы.Месяц МЕЖДУ ВтПериодыКосты.ПериодНачало И ВтПериодыКосты.ПериодКонец)
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ЕСТЬNULL(ВтКостыПоМесяцам.Сотрудник, ВтПодразделенияПоМесяцам.Сотрудник) КАК Сотрудник,
	ЕСТЬNULL(ВтКостыПоМесяцам.НачалоПериода, ВтПодразделенияПоМесяцам.НачалоПериода) КАК Месяц,
	ВтКостыПоМесяцам.Кост,
	ВтПодразделенияПоМесяцам.Подразделение
ИЗ
	ВтПодразделенияПоМесяцам КАК ВтПодразделенияПоМесяцам
		ПОЛНОЕ СОЕДИНЕНИЕ ВтКостыПоМесяцам КАК ВтКостыПоМесяцам
		ПО ВтПодразделенияПоМесяцам.Сотрудник = ВтКостыПоМесяцам.Сотрудник
			И ВтПодразделенияПоМесяцам.НачалоПериода = ВтКостыПоМесяцам.НачалоПериода

УПОРЯДОЧИТЬ ПО
	Сотрудник,
	Месяц"},
{"#",acf6192e-81ca-46ef-93a6-5a6968b78663,
{8,
{8,
{0,"ИмяПараметра",
{"Pattern",
{"S",50,1}
},"Имя параметра",22},
{1,"ЭтоВыражение",
{"Pattern",
{"B"}
},"ЭтоВыражение",0},
{2,"ЗначениеПараметра",
{"Pattern",
{"#",280f5f0e-9c8a-49cc-bf6d-4d296cc17a63},
{"#",4772b3b4-f4a3-49c0-a1a5-8cb5961511a3},
{"#",5a49abd5-936d-4f46-8499-9cb204efe378},
{"B"},
{"#",741ae838-6e42-4ac0-b6a4-17e5604b0669},
{"#",872f7198-7083-4e3e-b57e-a2a9802c769e},
{"S",100,1},
{"D"},
{"N",15,3,0}
},"Значение параметра",28},
{3,"МоментВремениДата",
{"Pattern",
{"D"}
},"Момент времени дата",15},
{4,"МоментВремениСсылка",
{"Pattern",
{"#",38bfd075-3e63-4aaa-a93e-94521380d579}
},"Момент времени ссылка",15},
{5,"ГраницаЗначение",
{"Pattern",
{"#",38bfd075-3e63-4aaa-a93e-94521380d579},
{"D"}
},"Граница значение",15},
{6,"ГраницаВид",
{"Pattern",
{"S"}
},"Граница вид сравнения",15},
{7,"ТаблицаЗначений",
{"Pattern"},"",0}
},
{2,8,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,
{1,4,
{2,0,8,
{"S","КонецПериода"},
{"B",0},
{"D",20171231000000},
{"D",00010101000000},
{"U"},
{"U"},
{"S",""},
{"U"},0},
{2,1,8,
{"S","НачалоПериода"},
{"B",0},
{"D",20170101000000},
{"D",00010101000000},
{"U"},
{"U"},
{"S",""},
{"U"},0},
{2,2,8,
{"S","Организация"},
{"B",0},
{"#",99a69cd8-ab6b-4aa6-8475-1fe937dc6241,103:8f1b00155d329d3111e71203a815385f},
{"D",00010101000000},
{"U"},
{"U"},
{"S",""},
{"U"},0},
{2,3,8,
{"S","ВидДополнительнойАналитикиУУ"},
{"B",0},
{"#",af50d627-2650-4410-aaf0-8cf34c5997bc,12242:9e1af62ce9b4e3534f55bff307437d31},
{"D",00010101000000},
{"U"},
{"U"},
{"S",""},
{"U"},0}
},-1,3}
}
},0},
{2,9,3,
{"D",20171101165606},
{"S","ВЫБРАТЬ РАЗЛИЧНЫЕ
	НАЧАЛОПЕРИОДА(РегламентированныйПроизводственныйКалендарь.ДатаКалендаря, МЕСЯЦ) КАК Месяц
ПОМЕСТИТЬ ВтМесяцы
ИЗ
	РегистрСведений.РегламентированныйПроизводственныйКалендарь КАК РегламентированныйПроизводственныйКалендарь
ГДЕ
	РегламентированныйПроизводственныйКалендарь.ДатаКалендаря МЕЖДУ &НачалоПериода И &КонецПериода
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	икЗначенияДополнительныхАналитикУУОбъектов.Сотрудник КАК Сотрудник,
	икЗначенияДополнительныхАналитикУУОбъектов.ЗначениеДополнительнойАналитикиУУ КАК Кост,
	икЗначенияДополнительныхАналитикУУОбъектов.Период КАК Период
ПОМЕСТИТЬ ВтКосты
ИЗ
	РегистрСведений.икЗначенияДополнительныхАналитикУУОбъектов КАК икЗначенияДополнительныхАналитикУУОбъектов
ГДЕ
	икЗначенияДополнительныхАналитикУУОбъектов.ВидДополнительнойАналитикиУУ = &ВидДополнительнойАналитикиУУ
	И икЗначенияДополнительныхАналитикУУОбъектов.Период МЕЖДУ &НачалоПериода И &КонецПериода
	И (икЗначенияДополнительныхАналитикУУОбъектов.Сотрудник.ДатаУвольнения = ДАТАВРЕМЯ(1, 1, 1)
			ИЛИ икЗначенияДополнительныхАналитикУУОбъектов.Сотрудник.ДатаУвольнения > &НачалоПериода)

ОБЪЕДИНИТЬ

ВЫБРАТЬ
	икЗначенияДополнительныхАналитикУУОбъектовСрезПоследних.Сотрудник,
	икЗначенияДополнительныхАналитикУУОбъектовСрезПоследних.ЗначениеДополнительнойАналитикиУУ,
	&НачалоПериода
ИЗ
	РегистрСведений.икЗначенияДополнительныхАналитикУУОбъектов.СрезПоследних(&НачалоПериода, ВидДополнительнойАналитикиУУ = &ВидДополнительнойАналитикиУУ) КАК икЗначенияДополнительныхАналитикУУОбъектовСрезПоследних
ГДЕ
	икЗначенияДополнительныхАналитикУУОбъектовСрезПоследних.ВидДополнительнойАналитикиУУ = &ВидДополнительнойАналитикиУУ
	И икЗначенияДополнительныхАналитикУУОбъектовСрезПоследних.Период МЕЖДУ &НачалоПериода И &КонецПериода
	И (икЗначенияДополнительныхАналитикУУОбъектовСрезПоследних.Сотрудник.ДатаУвольнения = ДАТАВРЕМЯ(1, 1, 1)
			ИЛИ икЗначенияДополнительныхАналитикУУОбъектовСрезПоследних.Сотрудник.ДатаУвольнения > &НачалоПериода)
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	РаботникиОрганизаций.Сотрудник КАК Сотрудник,
	РаботникиОрганизаций.Период КАК Период,
	РаботникиОрганизаций.ПодразделениеОрганизации КАК Подразделение
ПОМЕСТИТЬ ВтПодразделения
ИЗ
	РегистрСведений.РаботникиОрганизаций КАК РаботникиОрганизаций
ГДЕ
	РаботникиОрганизаций.Организация = &Организация
	И РаботникиОрганизаций.ПериодЗавершения = ДАТАВРЕМЯ(1, 1, 1)
	И РаботникиОрганизаций.Период МЕЖДУ &НачалоПериода И &КонецПериода
	И (РаботникиОрганизаций.Сотрудник.ДатаУвольнения = ДАТАВРЕМЯ(1, 1, 1)
			ИЛИ РаботникиОрганизаций.Сотрудник.ДатаУвольнения > &НачалоПериода)

ОБЪЕДИНИТЬ

ВЫБРАТЬ
	РаботникиОрганизаций.Сотрудник,
	РаботникиОрганизаций.Период,
	РаботникиОрганизаций.ПодразделениеОрганизацииЗавершения
ИЗ
	РегистрСведений.РаботникиОрганизаций КАК РаботникиОрганизаций
ГДЕ
	РаботникиОрганизаций.Организация = &Организация
	И РаботникиОрганизаций.ПериодЗавершения МЕЖДУ &НачалоПериода И &КонецПериода
	И (РаботникиОрганизаций.Сотрудник.ДатаУвольнения = ДАТАВРЕМЯ(1, 1, 1)
			ИЛИ РаботникиОрганизаций.Сотрудник.ДатаУвольнения > &НачалоПериода)

ОБЪЕДИНИТЬ

ВЫБРАТЬ
	РаботникиОрганизацийСрезПоследних.Сотрудник,
	&НачалоПериода,
	РаботникиОрганизацийСрезПоследних.ПодразделениеОрганизации
ИЗ
	РегистрСведений.РаботникиОрганизаций.СрезПоследних(
			&НачалоПериода,
			Организация = &Организация
				И (Сотрудник.ДатаУвольнения = ДАТАВРЕМЯ(1, 1, 1)
					ИЛИ Сотрудник.ДатаУвольнения > &НачалоПериода)) КАК РаботникиОрганизацийСрезПоследних
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ВтПодразделения.Сотрудник КАК Сотрудник,
	ВтПодразделения.Подразделение,
	ВтПодразделения.Период КАК ПериодНачало,
	МИНИМУМ(ВЫБОР
			КОГДА ВтПодразделения1.Период ЕСТЬ NULL 
				ТОГДА КОНЕЦПЕРИОДА(&КонецПериода, МЕСЯЦ)
			ИНАЧЕ ДОБАВИТЬКДАТЕ(ВтПодразделения1.Период, ДЕНЬ, -1)
		КОНЕЦ) КАК ПериодКонец
ПОМЕСТИТЬ ВтПериодыПодразделения
ИЗ
	ВтПодразделения КАК ВтПодразделения
		ЛЕВОЕ СОЕДИНЕНИЕ ВтПодразделения КАК ВтПодразделения1
		ПО ВтПодразделения.Сотрудник = ВтПодразделения1.Сотрудник
			И ВтПодразделения.Период < ВтПодразделения1.Период

СГРУППИРОВАТЬ ПО
	ВтПодразделения.Период,
	ВтПодразделения.Сотрудник,
	ВтПодразделения.Подразделение
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ВтКосты.Сотрудник КАК Сотрудник,
	ВтКосты.Период КАК ПериодНачало,
	МИНИМУМ(ВЫБОР
			КОГДА ВтКосты1.Период ЕСТЬ NULL 
				ТОГДА КОНЕЦПЕРИОДА(&КонецПериода, МЕСЯЦ)
			ИНАЧЕ ДОБАВИТЬКДАТЕ(ВтКосты1.Период, ДЕНЬ, -1)
		КОНЕЦ) КАК ПериодКонец,
	ВтКосты.Кост
ПОМЕСТИТЬ ВтПериодыКосты
ИЗ
	ВтКосты КАК ВтКосты
		ЛЕВОЕ СОЕДИНЕНИЕ ВтКосты КАК ВтКосты1
		ПО ВтКосты.Сотрудник = ВтКосты1.Сотрудник
			И ВтКосты.Период < ВтКосты1.Период

СГРУППИРОВАТЬ ПО
	ВтКосты.Период,
	ВтКосты.Сотрудник,
	ВтКосты.Кост
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ВтПериодыПодразделения.Сотрудник КАК Сотрудник,
	ВтПериодыПодразделения.Подразделение,
	ВтМесяцы.Месяц КАК НачалоПериода
ПОМЕСТИТЬ ВтПодразделенияПоМесяцам
ИЗ
	ВтМесяцы КАК ВтМесяцы
		ЛЕВОЕ СОЕДИНЕНИЕ ВтПериодыПодразделения КАК ВтПериодыПодразделения
		ПО (ВтМесяцы.Месяц МЕЖДУ НАЧАЛОПЕРИОДА(ВтПериодыПодразделения.ПериодНачало, МЕСЯЦ) И КОНЕЦПЕРИОДА(ВтПериодыПодразделения.ПериодКонец, МЕСЯЦ))
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ВтПериодыКосты.Сотрудник КАК Сотрудник,
	ВтМесяцы.Месяц КАК НачалоПериода,
	ВтПериодыКосты.Кост
ПОМЕСТИТЬ ВтКостыПоМесяцам
ИЗ
	ВтМесяцы КАК ВтМесяцы
		ЛЕВОЕ СОЕДИНЕНИЕ ВтПериодыКосты КАК ВтПериодыКосты
		ПО (ВтМесяцы.Месяц МЕЖДУ НАЧАЛОПЕРИОДА(ВтПериодыКосты.ПериодНачало, МЕСЯЦ) И КОНЕЦПЕРИОДА(ВтПериодыКосты.ПериодКонец, МЕСЯЦ))
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ЕСТЬNULL(ВтКостыПоМесяцам.Сотрудник, ВтПодразделенияПоМесяцам.Сотрудник) КАК Сотрудник,
	ЕСТЬNULL(ВтКостыПоМесяцам.НачалоПериода, ВтПодразделенияПоМесяцам.НачалоПериода) КАК Месяц,
	ВтКостыПоМесяцам.Кост,
	ВтПодразделенияПоМесяцам.Подразделение
ИЗ
	ВтПодразделенияПоМесяцам КАК ВтПодразделенияПоМесяцам
		ПОЛНОЕ СОЕДИНЕНИЕ ВтКостыПоМесяцам КАК ВтКостыПоМесяцам
		ПО ВтПодразделенияПоМесяцам.Сотрудник = ВтКостыПоМесяцам.Сотрудник
			И ВтПодразделенияПоМесяцам.НачалоПериода = ВтКостыПоМесяцам.НачалоПериода

УПОРЯДОЧИТЬ ПО
	Сотрудник,
	Месяц"},
{"#",acf6192e-81ca-46ef-93a6-5a6968b78663,
{8,
{8,
{0,"ИмяПараметра",
{"Pattern",
{"S",50,1}
},"Имя параметра",22},
{1,"ЭтоВыражение",
{"Pattern",
{"B"}
},"ЭтоВыражение",0},
{2,"ЗначениеПараметра",
{"Pattern",
{"#",280f5f0e-9c8a-49cc-bf6d-4d296cc17a63},
{"#",4772b3b4-f4a3-49c0-a1a5-8cb5961511a3},
{"#",5a49abd5-936d-4f46-8499-9cb204efe378},
{"B"},
{"#",741ae838-6e42-4ac0-b6a4-17e5604b0669},
{"#",872f7198-7083-4e3e-b57e-a2a9802c769e},
{"S",100,1},
{"D"},
{"N",15,3,0}
},"Значение параметра",28},
{3,"МоментВремениДата",
{"Pattern",
{"D"}
},"Момент времени дата",15},
{4,"МоментВремениСсылка",
{"Pattern",
{"#",38bfd075-3e63-4aaa-a93e-94521380d579}
},"Момент времени ссылка",15},
{5,"ГраницаЗначение",
{"Pattern",
{"#",38bfd075-3e63-4aaa-a93e-94521380d579},
{"D"}
},"Граница значение",15},
{6,"ГраницаВид",
{"Pattern",
{"S"}
},"Граница вид сравнения",15},
{7,"ТаблицаЗначений",
{"Pattern"},"",0}
},
{2,8,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,
{1,4,
{2,0,8,
{"S","КонецПериода"},
{"B",0},
{"D",20171231000000},
{"D",00010101000000},
{"U"},
{"U"},
{"S",""},
{"U"},0},
{2,1,8,
{"S","НачалоПериода"},
{"B",0},
{"D",20170101000000},
{"D",00010101000000},
{"U"},
{"U"},
{"S",""},
{"U"},0},
{2,2,8,
{"S","Организация"},
{"B",0},
{"#",99a69cd8-ab6b-4aa6-8475-1fe937dc6241,103:8f1b00155d329d3111e71203a815385f},
{"D",00010101000000},
{"U"},
{"U"},
{"S",""},
{"U"},0},
{2,3,8,
{"S","ВидДополнительнойАналитикиУУ"},
{"B",0},
{"#",af50d627-2650-4410-aaf0-8cf34c5997bc,12242:9e1af62ce9b4e3534f55bff307437d31},
{"D",00010101000000},
{"U"},
{"U"},
{"S",""},
{"U"},0}
},-1,3}
}
},0},
{2,10,3,
{"D",20171103083158},
{"S","ВЫБРАТЬ РАЗЛИЧНЫЕ
	НАЧАЛОПЕРИОДА(РегламентированныйПроизводственныйКалендарь.ДатаКалендаря, МЕСЯЦ) КАК Месяц
ПОМЕСТИТЬ ВтМесяцы
ИЗ
	РегистрСведений.РегламентированныйПроизводственныйКалендарь КАК РегламентированныйПроизводственныйКалендарь
ГДЕ
	РегламентированныйПроизводственныйКалендарь.ДатаКалендаря МЕЖДУ &НачалоПериода И &КонецПериода
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	икЗначенияДополнительныхАналитикУУОбъектов.Сотрудник.Физлицо КАК Сотрудник,
	икЗначенияДополнительныхАналитикУУОбъектов.Период КАК Период,
	икЗначенияДополнительныхАналитикУУОбъектов.ЗначениеДополнительнойАналитикиУУ КАК Значение
ПОМЕСТИТЬ ВтИсходная1
ИЗ
	РегистрСведений.икЗначенияДополнительныхАналитикУУОбъектов КАК икЗначенияДополнительныхАналитикУУОбъектов
ГДЕ
	икЗначенияДополнительныхАналитикУУОбъектов.ВидДополнительнойАналитикиУУ = &КостЦентр
	И икЗначенияДополнительныхАналитикУУОбъектов.Период МЕЖДУ &НачалоПериода И &КонецПериода
	И (икЗначенияДополнительныхАналитикУУОбъектов.Сотрудник.ДатаУвольнения = ДАТАВРЕМЯ(1, 1, 1)
			ИЛИ икЗначенияДополнительныхАналитикУУОбъектов.Сотрудник.ДатаУвольнения > &НачалоПериода)

ОБЪЕДИНИТЬ

ВЫБРАТЬ
	икЗначенияДополнительныхАналитикУУОбъектовСрезПоследних.Сотрудник.Физлицо,
	&НачалоПериода,
	икЗначенияДополнительныхАналитикУУОбъектовСрезПоследних.ЗначениеДополнительнойАналитикиУУ
ИЗ
	РегистрСведений.икЗначенияДополнительныхАналитикУУОбъектов.СрезПоследних(
			&НачалоПериода,
			ВидДополнительнойАналитикиУУ = &КостЦентр
				И (Сотрудник.ДатаУвольнения = ДАТАВРЕМЯ(1, 1, 1)
					ИЛИ Сотрудник.ДатаУвольнения > &НачалоПериода)) КАК икЗначенияДополнительныхАналитикУУОбъектовСрезПоследних
ГДЕ
	(икЗначенияДополнительныхАналитикУУОбъектовСрезПоследних.Сотрудник.ДатаУвольнения = ДАТАВРЕМЯ(1, 1, 1)
			ИЛИ икЗначенияДополнительныхАналитикУУОбъектовСрезПоследних.Сотрудник.ДатаУвольнения > &НачалоПериода)
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ВтКосты.Сотрудник КАК Сотрудник,
	ВтКосты.Период КАК ПериодНачало,
	МИНИМУМ(ВЫБОР
			КОГДА ВтКосты1.Период ЕСТЬ NULL 
				ТОГДА КОНЕЦПЕРИОДА(&КонецПериода, МЕСЯЦ)
			ИНАЧЕ ДОБАВИТЬКДАТЕ(ВтКосты1.Период, ДЕНЬ, -1)
		КОНЕЦ) КАК ПериодКонец,
	ВтКосты.Значение
ПОМЕСТИТЬ ВтПериодыИсходная1
ИЗ
	ВтИсходная1 КАК ВтКосты
		ЛЕВОЕ СОЕДИНЕНИЕ ВтИсходная1 КАК ВтКосты1
		ПО ВтКосты.Сотрудник = ВтКосты1.Сотрудник
			И ВтКосты.Период < ВтКосты1.Период

СГРУППИРОВАТЬ ПО
	ВтКосты.Период,
	ВтКосты.Сотрудник,
	ВтКосты.Значение
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ВтПериодыКосты.Сотрудник КАК Сотрудник,
	ВтМесяцы.Месяц КАК ПериодРегистрации,
	ВтПериодыКосты.Значение
ПОМЕСТИТЬ ВтМесяцаИсходная1
ИЗ
	ВтМесяцы КАК ВтМесяцы
		ЛЕВОЕ СОЕДИНЕНИЕ ВтПериодыИсходная1 КАК ВтПериодыКосты
		ПО (ВтМесяцы.Месяц МЕЖДУ НАЧАЛОПЕРИОДА(ВтПериодыКосты.ПериодНачало, МЕСЯЦ) И КОНЕЦПЕРИОДА(ВтПериодыКосты.ПериодКонец, МЕСЯЦ))
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	икЗначенияДополнительныхАналитикУУОбъектов.Сотрудник.Физлицо КАК Сотрудник,
	икЗначенияДополнительныхАналитикУУОбъектов.Период КАК Период,
	икЗначенияДополнительныхАналитикУУОбъектов.ЗначениеДополнительнойАналитикиУУ КАК Значение
ПОМЕСТИТЬ ВтИсходная2
ИЗ
	РегистрСведений.икЗначенияДополнительныхАналитикУУОбъектов КАК икЗначенияДополнительныхАналитикУУОбъектов
ГДЕ
	икЗначенияДополнительныхАналитикУУОбъектов.ВидДополнительнойАналитикиУУ = &Регион
	И икЗначенияДополнительныхАналитикУУОбъектов.Период МЕЖДУ &НачалоПериода И &КонецПериода
	И (икЗначенияДополнительныхАналитикУУОбъектов.Сотрудник.ДатаУвольнения = ДАТАВРЕМЯ(1, 1, 1)
			ИЛИ икЗначенияДополнительныхАналитикУУОбъектов.Сотрудник.ДатаУвольнения > &НачалоПериода)

ОБЪЕДИНИТЬ

ВЫБРАТЬ
	икЗначенияДополнительныхАналитикУУОбъектовСрезПоследних.Сотрудник.Физлицо,
	&НачалоПериода,
	икЗначенияДополнительныхАналитикУУОбъектовСрезПоследних.ЗначениеДополнительнойАналитикиУУ
ИЗ
	РегистрСведений.икЗначенияДополнительныхАналитикУУОбъектов.СрезПоследних(
			&НачалоПериода,
			ВидДополнительнойАналитикиУУ = &Регион
				И (Сотрудник.ДатаУвольнения = ДАТАВРЕМЯ(1, 1, 1)
					ИЛИ Сотрудник.ДатаУвольнения > &НачалоПериода)) КАК икЗначенияДополнительныхАналитикУУОбъектовСрезПоследних
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ВтИсходная2.Сотрудник КАК Сотрудник,
	ВтИсходная2.Период КАК ПериодНачало,
	МИНИМУМ(ВЫБОР
			КОГДА ВтИсходная21.Период ЕСТЬ NULL 
				ТОГДА КОНЕЦПЕРИОДА(&КонецПериода, МЕСЯЦ)
			ИНАЧЕ ДОБАВИТЬКДАТЕ(ВтИсходная21.Период, ДЕНЬ, -1)
		КОНЕЦ) КАК ПериодКонец,
	ВтИсходная2.Значение
ПОМЕСТИТЬ ВтПериодыИсходная2
ИЗ
	ВтИсходная2 КАК ВтИсходная2
		ЛЕВОЕ СОЕДИНЕНИЕ ВтИсходная2 КАК ВтИсходная21
		ПО ВтИсходная2.Сотрудник = ВтИсходная21.Сотрудник
			И ВтИсходная2.Период < ВтИсходная21.Период

СГРУППИРОВАТЬ ПО
	ВтИсходная2.Период,
	ВтИсходная2.Сотрудник,
	ВтИсходная2.Значение
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ВтПериодыИсходная2.Сотрудник КАК Сотрудник,
	ВтМесяцы.Месяц КАК ПериодРегистрации,
	ВтПериодыИсходная2.Значение
ПОМЕСТИТЬ ВтМесяцаИсходная2
ИЗ
	ВтМесяцы КАК ВтМесяцы
		ЛЕВОЕ СОЕДИНЕНИЕ ВтПериодыИсходная2 КАК ВтПериодыИсходная2
		ПО (ВтМесяцы.Месяц МЕЖДУ НАЧАЛОПЕРИОДА(ВтПериодыИсходная2.ПериодНачало, МЕСЯЦ) И КОНЕЦПЕРИОДА(ВтПериодыИсходная2.ПериодКонец, МЕСЯЦ))
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ЕСТЬNULL(ВтМесяцаИсходная1.Сотрудник, ВтМесяцаИсходная2.Сотрудник) КАК СотрудникФизлицоСсылка,
	ЕСТЬNULL(ВтМесяцаИсходная1.ПериодРегистрации, ВтМесяцаИсходная2.ПериодРегистрации) КАК ПериодРегистрации,
	ВтМесяцаИсходная1.Значение КАК КостЦентр,
	ВтМесяцаИсходная2.Значение КАК Регион
ИЗ
	ВтМесяцаИсходная1 КАК ВтМесяцаИсходная1
		ПОЛНОЕ СОЕДИНЕНИЕ ВтМесяцаИсходная2 КАК ВтМесяцаИсходная2
		ПО ВтМесяцаИсходная1.Сотрудник = ВтМесяцаИсходная2.Сотрудник
			И ВтМесяцаИсходная1.ПериодРегистрации = ВтМесяцаИсходная2.ПериодРегистрации"},
{"#",acf6192e-81ca-46ef-93a6-5a6968b78663,
{8,
{8,
{0,"ИмяПараметра",
{"Pattern",
{"S",50,1}
},"Имя параметра",22},
{1,"ЭтоВыражение",
{"Pattern",
{"B"}
},"ЭтоВыражение",0},
{2,"ЗначениеПараметра",
{"Pattern",
{"#",280f5f0e-9c8a-49cc-bf6d-4d296cc17a63},
{"#",4772b3b4-f4a3-49c0-a1a5-8cb5961511a3},
{"#",5a49abd5-936d-4f46-8499-9cb204efe378},
{"B"},
{"#",741ae838-6e42-4ac0-b6a4-17e5604b0669},
{"#",872f7198-7083-4e3e-b57e-a2a9802c769e},
{"S",100,1},
{"D"},
{"N",15,3,0}
},"Значение параметра",28},
{3,"МоментВремениДата",
{"Pattern",
{"D"}
},"Момент времени дата",15},
{4,"МоментВремениСсылка",
{"Pattern",
{"#",38bfd075-3e63-4aaa-a93e-94521380d579}
},"Момент времени ссылка",15},
{5,"ГраницаЗначение",
{"Pattern",
{"#",38bfd075-3e63-4aaa-a93e-94521380d579},
{"D"}
},"Граница значение",15},
{6,"ГраницаВид",
{"Pattern",
{"S"}
},"Граница вид сравнения",15},
{7,"ТаблицаЗначений",
{"Pattern"},"",0}
},
{2,8,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,
{1,4,
{2,0,8,
{"S","КонецПериода"},
{"B",0},
{"D",20171231000000},
{"D",00010101000000},
{"U"},
{"U"},
{"S",""},
{"U"},0},
{2,1,8,
{"S","НачалоПериода"},
{"B",0},
{"D",20170101000000},
{"D",00010101000000},
{"U"},
{"U"},
{"S",""},
{"U"},0},
{2,2,8,
{"S","КостЦентр"},
{"B",0},
{"#",af50d627-2650-4410-aaf0-8cf34c5997bc,12242:9e1af62ce9b4e3534f55bff307437d31},
{"D",00010101000000},
{"U"},
{"U"},
{"S",""},
{"U"},0},
{2,3,8,
{"S","Регион"},
{"B",0},
{"#",af50d627-2650-4410-aaf0-8cf34c5997bc,12242:a176771f44b79071471cfbdf325c78ae},
{"D",00010101000000},
{"U"},
{"U"},
{"S",""},
{"U"},0}
},-1,3}
}
},0},
{2,11,3,
{"D",20171103083215},
{"S","ВЫБРАТЬ РАЗЛИЧНЫЕ
	НАЧАЛОПЕРИОДА(РегламентированныйПроизводственныйКалендарь.ДатаКалендаря, МЕСЯЦ) КАК Месяц
ПОМЕСТИТЬ ВтМесяцы
ИЗ
	РегистрСведений.РегламентированныйПроизводственныйКалендарь КАК РегламентированныйПроизводственныйКалендарь
ГДЕ
	РегламентированныйПроизводственныйКалендарь.ДатаКалендаря МЕЖДУ &НачалоПериода И &КонецПериода
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	икЗначенияДополнительныхАналитикУУОбъектов.Сотрудник.Физлицо КАК Сотрудник,
	икЗначенияДополнительныхАналитикУУОбъектов.Период КАК Период,
	икЗначенияДополнительныхАналитикУУОбъектов.ЗначениеДополнительнойАналитикиУУ КАК Значение
ПОМЕСТИТЬ ВтИсходная1
ИЗ
	РегистрСведений.икЗначенияДополнительныхАналитикУУОбъектов КАК икЗначенияДополнительныхАналитикУУОбъектов
ГДЕ
	икЗначенияДополнительныхАналитикУУОбъектов.ВидДополнительнойАналитикиУУ = &КостЦентр
	И икЗначенияДополнительныхАналитикУУОбъектов.Период МЕЖДУ &НачалоПериода И &КонецПериода
	И (икЗначенияДополнительныхАналитикУУОбъектов.Сотрудник.ДатаУвольнения = ДАТАВРЕМЯ(1, 1, 1)
			ИЛИ икЗначенияДополнительныхАналитикУУОбъектов.Сотрудник.ДатаУвольнения > &НачалоПериода)

ОБЪЕДИНИТЬ

ВЫБРАТЬ
	икЗначенияДополнительныхАналитикУУОбъектовСрезПоследних.Сотрудник.Физлицо,
	&НачалоПериода,
	икЗначенияДополнительныхАналитикУУОбъектовСрезПоследних.ЗначениеДополнительнойАналитикиУУ
ИЗ
	РегистрСведений.икЗначенияДополнительныхАналитикУУОбъектов.СрезПоследних(
			&НачалоПериода,
			ВидДополнительнойАналитикиУУ = &КостЦентр
				И (Сотрудник.ДатаУвольнения = ДАТАВРЕМЯ(1, 1, 1)
					ИЛИ Сотрудник.ДатаУвольнения > &НачалоПериода)) КАК икЗначенияДополнительныхАналитикУУОбъектовСрезПоследних
ГДЕ
	(икЗначенияДополнительныхАналитикУУОбъектовСрезПоследних.Сотрудник.ДатаУвольнения = ДАТАВРЕМЯ(1, 1, 1)
			ИЛИ икЗначенияДополнительныхАналитикУУОбъектовСрезПоследних.Сотрудник.ДатаУвольнения > &НачалоПериода)
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ВтКосты.Сотрудник КАК Сотрудник,
	ВтКосты.Период КАК ПериодНачало,
	МИНИМУМ(ВЫБОР
			КОГДА ВтКосты1.Период ЕСТЬ NULL 
				ТОГДА КОНЕЦПЕРИОДА(&КонецПериода, МЕСЯЦ)
			ИНАЧЕ ДОБАВИТЬКДАТЕ(ВтКосты1.Период, ДЕНЬ, -1)
		КОНЕЦ) КАК ПериодКонец,
	ВтКосты.Значение
ПОМЕСТИТЬ ВтПериодыИсходная1
ИЗ
	ВтИсходная1 КАК ВтКосты
		ЛЕВОЕ СОЕДИНЕНИЕ ВтИсходная1 КАК ВтКосты1
		ПО ВтКосты.Сотрудник = ВтКосты1.Сотрудник
			И ВтКосты.Период < ВтКосты1.Период

СГРУППИРОВАТЬ ПО
	ВтКосты.Период,
	ВтКосты.Сотрудник,
	ВтКосты.Значение
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ВтПериодыКосты.Сотрудник КАК Сотрудник,
	ВтМесяцы.Месяц КАК ПериодРегистрации,
	ВтПериодыКосты.Значение
ПОМЕСТИТЬ ВтМесяцаИсходная1
ИЗ
	ВтМесяцы КАК ВтМесяцы
		ЛЕВОЕ СОЕДИНЕНИЕ ВтПериодыИсходная1 КАК ВтПериодыКосты
		ПО (ВтМесяцы.Месяц МЕЖДУ НАЧАЛОПЕРИОДА(ВтПериодыКосты.ПериодНачало, МЕСЯЦ) И КОНЕЦПЕРИОДА(ВтПериодыКосты.ПериодКонец, МЕСЯЦ))
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	икЗначенияДополнительныхАналитикУУОбъектов.Сотрудник.Физлицо КАК Сотрудник,
	икЗначенияДополнительныхАналитикУУОбъектов.Период КАК Период,
	икЗначенияДополнительныхАналитикУУОбъектов.ЗначениеДополнительнойАналитикиУУ КАК Значение
ПОМЕСТИТЬ ВтИсходная2
ИЗ
	РегистрСведений.икЗначенияДополнительныхАналитикУУОбъектов КАК икЗначенияДополнительныхАналитикУУОбъектов
ГДЕ
	икЗначенияДополнительныхАналитикУУОбъектов.ВидДополнительнойАналитикиУУ = &Регион
	И икЗначенияДополнительныхАналитикУУОбъектов.Период МЕЖДУ &НачалоПериода И &КонецПериода
	И (икЗначенияДополнительныхАналитикУУОбъектов.Сотрудник.ДатаУвольнения = ДАТАВРЕМЯ(1, 1, 1)
			ИЛИ икЗначенияДополнительныхАналитикУУОбъектов.Сотрудник.ДатаУвольнения > &НачалоПериода)

ОБЪЕДИНИТЬ

ВЫБРАТЬ
	икЗначенияДополнительныхАналитикУУОбъектовСрезПоследних.Сотрудник.Физлицо,
	&НачалоПериода,
	икЗначенияДополнительныхАналитикУУОбъектовСрезПоследних.ЗначениеДополнительнойАналитикиУУ
ИЗ
	РегистрСведений.икЗначенияДополнительныхАналитикУУОбъектов.СрезПоследних(
			&НачалоПериода,
			ВидДополнительнойАналитикиУУ = &Регион
				И (Сотрудник.ДатаУвольнения = ДАТАВРЕМЯ(1, 1, 1)
					ИЛИ Сотрудник.ДатаУвольнения > &НачалоПериода)) КАК икЗначенияДополнительныхАналитикУУОбъектовСрезПоследних
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ВтИсходная2.Сотрудник КАК Сотрудник,
	ВтИсходная2.Период КАК ПериодНачало,
	МИНИМУМ(ВЫБОР
			КОГДА ВтИсходная21.Период ЕСТЬ NULL 
				ТОГДА КОНЕЦПЕРИОДА(&КонецПериода, МЕСЯЦ)
			ИНАЧЕ ДОБАВИТЬКДАТЕ(ВтИсходная21.Период, ДЕНЬ, -1)
		КОНЕЦ) КАК ПериодКонец,
	ВтИсходная2.Значение
ПОМЕСТИТЬ ВтПериодыИсходная2
ИЗ
	ВтИсходная2 КАК ВтИсходная2
		ЛЕВОЕ СОЕДИНЕНИЕ ВтИсходная2 КАК ВтИсходная21
		ПО ВтИсходная2.Сотрудник = ВтИсходная21.Сотрудник
			И ВтИсходная2.Период < ВтИсходная21.Период

СГРУППИРОВАТЬ ПО
	ВтИсходная2.Период,
	ВтИсходная2.Сотрудник,
	ВтИсходная2.Значение
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ВтПериодыИсходная2.Сотрудник КАК Сотрудник,
	ВтМесяцы.Месяц КАК ПериодРегистрации,
	ВтПериодыИсходная2.Значение
ПОМЕСТИТЬ ВтМесяцаИсходная2
ИЗ
	ВтМесяцы КАК ВтМесяцы
		ЛЕВОЕ СОЕДИНЕНИЕ ВтПериодыИсходная2 КАК ВтПериодыИсходная2
		ПО (ВтМесяцы.Месяц МЕЖДУ НАЧАЛОПЕРИОДА(ВтПериодыИсходная2.ПериодНачало, МЕСЯЦ) И КОНЕЦПЕРИОДА(ВтПериодыИсходная2.ПериодКонец, МЕСЯЦ))
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ЕСТЬNULL(ВтМесяцаИсходная1.Сотрудник, ВтМесяцаИсходная2.Сотрудник) КАК СотрудникФизлицоСсылка,
	ЕСТЬNULL(ВтМесяцаИсходная1.ПериодРегистрации, ВтМесяцаИсходная2.ПериодРегистрации) КАК ПериодРегистрации,
	ВтМесяцаИсходная1.Значение КАК КостЦентр,
	ВтМесяцаИсходная2.Значение КАК Регион
ИЗ
	ВтМесяцаИсходная1 КАК ВтМесяцаИсходная1
		ПОЛНОЕ СОЕДИНЕНИЕ ВтМесяцаИсходная2 КАК ВтМесяцаИсходная2
		ПО ВтМесяцаИсходная1.Сотрудник = ВтМесяцаИсходная2.Сотрудник
			И ВтМесяцаИсходная1.ПериодРегистрации = ВтМесяцаИсходная2.ПериодРегистрации

УПОРЯДОЧИТЬ ПО
	СотрудникФизлицоСсылка,
	ПериодРегистрации"},
{"#",acf6192e-81ca-46ef-93a6-5a6968b78663,
{8,
{8,
{0,"ИмяПараметра",
{"Pattern",
{"S",50,1}
},"Имя параметра",22},
{1,"ЭтоВыражение",
{"Pattern",
{"B"}
},"ЭтоВыражение",0},
{2,"ЗначениеПараметра",
{"Pattern",
{"#",280f5f0e-9c8a-49cc-bf6d-4d296cc17a63},
{"#",4772b3b4-f4a3-49c0-a1a5-8cb5961511a3},
{"#",5a49abd5-936d-4f46-8499-9cb204efe378},
{"B"},
{"#",741ae838-6e42-4ac0-b6a4-17e5604b0669},
{"#",872f7198-7083-4e3e-b57e-a2a9802c769e},
{"S",100,1},
{"D"},
{"N",15,3,0}
},"Значение параметра",28},
{3,"МоментВремениДата",
{"Pattern",
{"D"}
},"Момент времени дата",15},
{4,"МоментВремениСсылка",
{"Pattern",
{"#",38bfd075-3e63-4aaa-a93e-94521380d579}
},"Момент времени ссылка",15},
{5,"ГраницаЗначение",
{"Pattern",
{"#",38bfd075-3e63-4aaa-a93e-94521380d579},
{"D"}
},"Граница значение",15},
{6,"ГраницаВид",
{"Pattern",
{"S"}
},"Граница вид сравнения",15},
{7,"ТаблицаЗначений",
{"Pattern"},"",0}
},
{2,8,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,
{1,4,
{2,0,8,
{"S","КонецПериода"},
{"B",0},
{"D",20171231000000},
{"D",00010101000000},
{"U"},
{"U"},
{"S",""},
{"U"},0},
{2,1,8,
{"S","НачалоПериода"},
{"B",0},
{"D",20170101000000},
{"D",00010101000000},
{"U"},
{"U"},
{"S",""},
{"U"},0},
{2,2,8,
{"S","КостЦентр"},
{"B",0},
{"#",af50d627-2650-4410-aaf0-8cf34c5997bc,12242:9e1af62ce9b4e3534f55bff307437d31},
{"D",00010101000000},
{"U"},
{"U"},
{"S",""},
{"U"},0},
{2,3,8,
{"S","Регион"},
{"B",0},
{"#",af50d627-2650-4410-aaf0-8cf34c5997bc,12242:a176771f44b79071471cfbdf325c78ae},
{"D",00010101000000},
{"U"},
{"U"},
{"S",""},
{"U"},0}
},-1,3}
}
},0}
},-1,11}
}
},
{"D",20171103083215},
{"U"},0}
},12,1}
}
}